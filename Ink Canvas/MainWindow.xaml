<Window Name="window" x:Class="Ink_Canvas.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Ink_Canvas"
        xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
        xmlns:ikw="http://schemas.inkore.net/lib/ui/wpf"
        xmlns:c="clr-namespace:Ink_Canvas.Converter"
        xmlns:Controls="http://schemas.microsoft.com/netfx/2009/xaml/presentation"
        mc:Ignorable="d"
        AllowsTransparency="True"
        WindowStyle="None"
        ResizeMode="NoResize"
        WindowState="Maximized"
        Loaded="Window_Loaded"
        Background="Transparent"
        ShowInTaskbar="False"
        Title="Ink Canvas 画板"
        Topmost="True"
        KeyDown="Window_KeyDown"
        Closing="Window_Closing"
        Closed="Window_Closed"
        PreviewKeyDown="Main_Grid_PreviewKeyDown"
        Height="5500" Width="1440"
        MouseWheel="Window_MouseWheel"
        Foreground="Black"
        Stylus.IsPressAndHoldEnabled="False">
    <!--资源中添加命令-->
    <Window.Resources>
        <c:VisibilityConverter x:Key="VisibilityConverter" />
        <c:IsEnabledToOpacityConverter x:Key="IsEnabledToOpacityConverter" />
        <RoutedUICommand x:Key="KeyExit" Text=" " />
        <RoutedUICommand x:Key="HotKey_Command_Undo" Text=" " />
        <RoutedUICommand x:Key="HotKey_Command_Redo" Text=" " />
        <RoutedUICommand x:Key="HotKey_Command_Clear" Text=" " />
        <RoutedUICommand x:Key="HotKey_Capture" Text=" " />
        <RoutedUICommand x:Key="HotKey_Hide" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToDrawTool" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToQuitDrawTool" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToSelect" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToEraser" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToBoard" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen1" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen2" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen3" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen4" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen5" Text=" " />
        <RoutedUICommand x:Key="HotKey_DrawLine" Text=" " />
    </Window.Resources>
    <!--输入命令绑定-->
    <Window.InputBindings>
        <KeyBinding Gesture="Shift+Esc" Command="{StaticResource KeyExit}" />
        <KeyBinding Modifiers="Control" Key="Z" Command="{StaticResource HotKey_Command_Undo}" />
        <KeyBinding Modifiers="Control" Key="Y" Command="{StaticResource HotKey_Command_Redo}" />
        <KeyBinding Modifiers="Control" Key="E" Command="{StaticResource HotKey_Command_Clear}" />
        <KeyBinding Modifiers="Alt" Key="C" Command="{StaticResource HotKey_Capture}" />
        <KeyBinding Modifiers="Alt" Key="V" Command="{StaticResource HotKey_Hide}" />
        <KeyBinding Modifiers="Alt" Key="S" Command="{StaticResource HotKey_ChangeToSelect}" />
        <KeyBinding Modifiers="Alt" Key="D" Command="{StaticResource HotKey_ChangeToDrawTool}" />
        <KeyBinding Modifiers="Alt" Key="Q" Command="{StaticResource HotKey_ChangeToQuitDrawTool}" />
        <KeyBinding Modifiers="Alt" Key="E" Command="{StaticResource HotKey_ChangeToEraser}" />
        <KeyBinding Modifiers="Alt" Key="B" Command="{StaticResource HotKey_ChangeToBoard}" />
        <KeyBinding Modifiers="Alt" Key="D1" Command="{StaticResource HotKey_ChangeToPen1}" />
        <KeyBinding Modifiers="Alt" Key="D2" Command="{StaticResource HotKey_ChangeToPen2}" />
        <KeyBinding Modifiers="Alt" Key="D3" Command="{StaticResource HotKey_ChangeToPen3}" />
        <KeyBinding Modifiers="Alt" Key="D4" Command="{StaticResource HotKey_ChangeToPen4}" />
        <KeyBinding Modifiers="Alt" Key="D5" Command="{StaticResource HotKey_ChangeToPen5}" />
        <KeyBinding Modifiers="Alt" Key="L" Command="{StaticResource HotKey_DrawLine}" />
    </Window.InputBindings>
    <!--命令执行方法绑定-->
    <Window.CommandBindings>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource KeyExit}" Executed="KeyExit" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Command_Undo}"
                        Executed="HotKey_Undo" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Command_Redo}"
                        Executed="HotKey_Redo" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Command_Clear}"
                        Executed="HotKey_Clear" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToDrawTool}"
                        Executed="KeyChangeToDrawTool" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToQuitDrawTool}"
                        Executed="KeyChangeToQuitDrawTool" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToSelect}"
                        Executed="KeyChangeToSelect" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToEraser}"
                        Executed="KeyChangeToEraser" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToBoard}"
                        Executed="KeyChangeToBoard" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Capture}"
                        Executed="KeyCapture" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Hide}"
                        Executed="KeyHide" />
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_DrawLine}"
                        Executed="KeyDrawLine" />
    </Window.CommandBindings>

    <Grid x:Name="Main_Grid" Background="#01FFFFFF">
        <!--// 画板幕布 //-->
        <Grid Name="GridBackgroundCoverHolder">
            <Grid Name="GridBackgroundCover" Visibility="Collapsed" Background="#1F1F1F" />
        </Grid>

        <Canvas Name="Canvas" />

        <Label Name="Label" Visibility="Collapsed" Foreground="Gray" Content="0" />

        <InkCanvas x:Name="inkCanvas" Background="Transparent" Cursor="Pen" ForceCursor="False"
                   TouchUp="Main_Grid_TouchUp" TouchDown="Main_Grid_TouchDown"
                   TouchMove="inkCanvas_TouchMove"
                   ManipulationDelta="Main_Grid_ManipulationDelta"
                   ManipulationCompleted="Main_Grid_ManipulationCompleted"
                   ManipulationInertiaStarting="inkCanvas_ManipulationInertiaStarting"
                   IsManipulationEnabled="True"
                   EditingModeChanged="inkCanvas_EditingModeChanged"
                   PreviewTouchDown="inkCanvas_PreviewTouchDown"
                   PreviewTouchUp="inkCanvas_PreviewTouchUp"
                   MouseDown="inkCanvas_MouseDown"
                   MouseMove="inkCanvas_MouseMove"
                   MouseUp="inkCanvas_MouseUp"
                   ManipulationStarting="inkCanvas_ManipulationStarting"
                   SelectionChanged="inkCanvas_SelectionChanged"
                   StrokeCollected="inkCanvas_StrokeCollected" />

        <Grid Visibility="{Binding ElementName=inkCanvas, Path=Visibility}">
            <Grid Name="GridInkCanvasSelectionCover"
                  MouseDown="GridInkCanvasSelectionCover_MouseDown"
                  MouseUp="GridInkCanvasSelectionCover_MouseUp"
                  IsManipulationEnabled="True"
                  ManipulationStarting="GridInkCanvasSelectionCover_ManipulationStarting"
                  ManipulationCompleted="GridInkCanvasSelectionCover_ManipulationCompleted"
                  ManipulationDelta="GridInkCanvasSelectionCover_ManipulationDelta"
                  PreviewTouchDown="GridInkCanvasSelectionCover_PreviewTouchDown"
                  PreviewTouchUp="GridInkCanvasSelectionCover_PreviewTouchUp"
                  TouchDown="GridInkCanvasSelectionCover_TouchDown"
                  TouchUp="GridInkCanvasSelectionCover_TouchUp"
                  Background="#01FFFFFF" Opacity="0.01" Visibility="Visible" Margin="1,0,-1,0" />
            <Border Name="BorderStrokeSelectionControl"
                    HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,900,0,0"
                    CornerRadius="5" Height="80"
                    Background="{DynamicResource FloatBarBackground}"
                    Visibility="{Binding ElementName=GridInkCanvasSelectionCover, Path=Visibility}"
                    BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                <Viewbox Margin="0,-2.5">
                    <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="10" Height="60">
                        <Border Name="BorderStrokeSelectionClone" Margin="0,2,-9,2" Background="Transparent"
                                CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionClone_MouseUp">
                            <ikw:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                <ui:FontIcon Height="25" Width="25" FontFamily="{StaticResource FluentIconFontFamily}"
                                             Glyph="&#xe8c8;" Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="克隆" FontSize="10" Foreground="{DynamicResource FloatBarForeground}"
                                           HorizontalAlignment="Center" />
                            </ikw:SimpleStackPanel>
                        </Border>
                        <Border Name="BorderStrokeSelectionCloneToNewBoard" Margin="0,2,-9,2" Background="Transparent"
                                CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Width="40" MouseDown="Border_MouseDown"
                                MouseUp="BorderStrokeSelectionCloneToNewBoard_MouseUp"
                                Visibility="{Binding Visibility, ElementName=GridBackgroundCover}">
                            <ikw:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                <ui:FontIcon Margin="1,0,0,0" Height="25" Width="25" FontSize="18"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf413;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="克隆至新页" FontSize="8" Foreground="{DynamicResource FloatBarForeground}"
                                           HorizontalAlignment="Center" />
                            </ikw:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}"
                                Background="{DynamicResource FloatBarForeground}" />
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Height="40">
                            <ikw:SimpleStackPanel VerticalAlignment="Center" Spacing="2" Margin="0,-10">
                                <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="10">
                                    <Image Source="{DynamicResource Rotate45DrawingImage}" Height="22"
                                           MouseDown="Border_MouseDown" MouseUp="ImageRotate45_MouseUp" />
                                    <Image Source="{DynamicResource Rotate90DrawingImage}" Height="22"
                                           MouseDown="Border_MouseDown" MouseUp="ImageRotate90_MouseUp" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="旋转" FontSize="10" HorizontalAlignment="Center"
                                           Foreground="{DynamicResource FloatBarForeground}" />
                            </ikw:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}"
                                Background="{DynamicResource FloatBarForeground}" />
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Height="40">
                            <ikw:SimpleStackPanel VerticalAlignment="Center" Margin="0,-10">
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <Image Source="{DynamicResource FlipDrawingImage}" Width="25" Height="25"
                                           MouseDown="Border_MouseDown" MouseUp="ImageFlipHorizontal_MouseUp" />
                                    <Image Source="{DynamicResource FlipDrawingImage}" Width="25" Height="25"
                                           MouseDown="Border_MouseDown" MouseUp="ImageFlipVertical_MouseUp"
                                           Margin="5,0,0,0" RenderTransformOrigin="0.5,0.5">
                                        <Image.RenderTransform>
                                            <TransformGroup>
                                                <ScaleTransform />
                                                <SkewTransform />
                                                <RotateTransform Angle="90" />
                                                <TranslateTransform />
                                            </TransformGroup>
                                        </Image.RenderTransform>
                                    </Image>
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="翻转" FontSize="10" HorizontalAlignment="Center"
                                           Foreground="{DynamicResource FloatBarForeground}" />
                            </ikw:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}"
                                Background="{DynamicResource FloatBarForeground}" />
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Height="40">
                            <ikw:SimpleStackPanel VerticalAlignment="Center" Spacing="5" Margin="0,-10">
                                <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="13">
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthDecrease_MouseUp">
                                        <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}" />
                                        <TextBlock Text="-" Foreground="{DynamicResource FloatBarForeground}"
                                                   VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                                   Margin="0,0,-2,-7" FontSize="15" />
                                    </Grid>
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthIncrease_MouseUp">
                                        <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}" />
                                        <TextBlock Text="+" Foreground="{DynamicResource FloatBarForeground}"
                                                   VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                                   Margin="0,0,-3,-4" FontSize="11" />
                                    </Grid>
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthRestore_MouseUp">
                                        <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}" />
                                        <Image Source="{DynamicResource AndroidRefreshDrawingImage}"
                                               VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                               Margin="0,0,-2,-2" Width="8">
                                        </Image>
                                    </Grid>
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="画笔粗细" FontSize="10" HorizontalAlignment="Center"
                                           Foreground="{DynamicResource FloatBarForeground}" />
                            </ikw:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}"
                                Background="{DynamicResource FloatBarForeground}" />
                        <Border Margin="-8,0,0,0"
                                CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionDelete_MouseUp">
                            <ikw:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                <ui:FontIcon Height="25" Width="25" FontFamily="{StaticResource FluentIconFontFamily}"
                                             Glyph="&#xe74d;" Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="删除" FontSize="10" Foreground="{DynamicResource FloatBarForeground}"
                                           HorizontalAlignment="Center" />
                            </ikw:SimpleStackPanel>
                        </Border>
                    </ikw:SimpleStackPanel>
                </Viewbox>
            </Border>
        </Grid>

        <Grid Visibility="Collapsed">
            <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
                <Viewbox Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" Height="36" CornerRadius="5"
                                Background="{DynamicResource FloatBarBackground}" BorderThickness="1"
                                BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6" MouseUp="GridPPTControlPrevious_MouseUp">
                                <Image
                                    Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}" />
                            </Grid>
                        </Border>
                        <Border Visibility="{Binding ElementName=PptNavigationBottomBtn, Path=Visibility}" Width="36"
                                Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}"
                                BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click">
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center"
                                           Foreground="{Binding ElementName=PptNavigationTextBlockBottom, Path=Foreground}"
                                           FontSize="{Binding ElementName=PptNavigationTextBlockBottom, Path=FontSize}"
                                           Text="{Binding ElementName=PptNavigationTextBlockBottom, Path=Text}" />
                            </Grid>
                        </Border>
                        <Border Width="36" Height="36" CornerRadius="5"
                                Background="{DynamicResource FloatBarBackground}" BorderThickness="1"
                                BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6" MouseUp="GridPPTControlNext_MouseUp">
                                <Image
                                    Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}" />
                            </Grid>
                        </Border>
                    </ikw:SimpleStackPanel>
                </Viewbox>
            </Grid>
        </Grid>

        <!--// 画板界面 //-->
        <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
            <!-- 左下角 -->
            <Viewbox x:Name="ViewboxBlackboardLeftSide" Margin="3,0,0,0" Height="55" HorizontalAlignment="Left"
                     VerticalAlignment="Bottom">
                <Viewbox.LayoutTransform>
                    <ScaleTransform x:Name="ViewboxBlackboardLeftSideScaleTransform" ScaleX="1" ScaleY="1" />
                </Viewbox.LayoutTransform>
                <Grid x:Name="BlackboardLeftSide" Visibility="Visible" Opacity="0.75" Margin="3,0,0,0" Height="55"
                      HorizontalAlignment="Left" VerticalAlignment="Bottom">
                    <ikw:SimpleStackPanel Orientation="Horizontal">
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="BtnWhiteBoardSwitchPrevious_Click" CornerRadius="5,0,0,5"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="1 1 0.25 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon Height="26" Width="26" VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe760;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock Text="上一页" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border Width="58" Height="55" Background="{DynamicResource BoardBarBackground}"
                                BorderThickness="0 1 0.25 1" BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="0,5">
                                <ikw:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Margin="0,4,0,2"
                                               Text="{Binding ElementName=TextBlockWhiteBoardIndexInfo, Path=Text}"
                                               Foreground="{DynamicResource BoardBarForeground}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="15" />
                                    <TextBlock Margin="0,3,0,0" Text="页码"
                                               Foreground="{DynamicResource BoardBarForeground}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="12" />
                                </ikw:SimpleStackPanel>
                            </Grid>
                        </Border>
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="BtnWhiteBoardSwitchNext_Click" CornerRadius="0,5,5,0"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="0 1 1 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon x:Name="BoardLeftPannelNextPage1" Height="26" Width="26"
                                             VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xecc8;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <ui:FontIcon x:Name="BoardLeftPannelNextPage2" Height="26" Width="0"
                                             VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe761;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock x:Name="BoardLeftPannelNextPageTextBlock" Text="加页"
                                           Foreground="{DynamicResource BoardBarForeground}" VerticalAlignment="Bottom"
                                           HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border Margin="5,0,0,0" Width="55" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="ImageBlackboard_MouseUp" CornerRadius="5"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon Height="26" Width="26" VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe944;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock Text="退出" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                    </ikw:SimpleStackPanel>
                </Grid>
            </Viewbox>
            <!-- 中间 -->
            <Viewbox x:Name="ViewboxBlackboardCenterSide" Margin="3,0,0,0" Height="55" HorizontalAlignment="Center"
                     VerticalAlignment="Bottom">
                <Viewbox.LayoutTransform>
                    <ScaleTransform x:Name="ViewboxBlackboardCenterSideScaleTransform" ScaleX="1" ScaleY="1" />
                </Viewbox.LayoutTransform>
                <Grid x:Name="BlackboardCenterSide" Visibility="Visible" Height="55" HorizontalAlignment="Center"
                      VerticalAlignment="Bottom">
                    <ikw:SimpleStackPanel Orientation="Horizontal">
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="TwoFingerGestureBorder_MouseUp" CornerRadius="5,0,0,5"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="1 1 0.25 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon Opacity="{Binding ElementName=EnableTwoFingerGestureBtn, Path=Opacity}"
                                             Height="26" Width="26" VerticalAlignment="Top" FontSize="28"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf271;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock Text="手势" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Grid Margin="0,0,0,5" Width="0">
                            <Viewbox Name="BoardTwoFingerGestureBorder" VerticalAlignment="Top" Visibility="Visible"
                                     Margin="-119,-177,-71,0" Height="173">
                                <Border CornerRadius="5" Background="{DynamicResource BoardBarBackground}"
                                        BorderBrush="{DynamicResource BoardBarBorderBrush}" BorderThickness="1"
                                        Height="135" Width="149">
                                    <ikw:SimpleStackPanel>
                                        <Border Background="{DynamicResource BoardBarTitleBackground}"
                                                BorderBrush="{DynamicResource BoardBarBorderBrush}" BorderThickness="1"
                                                CornerRadius="5,5,0,0" Margin="-1 -1 -1 0" Padding="15,5">
                                            <TextBlock Text="手势功能" Foreground="{DynamicResource BoardBarForeground}"
                                                       FontSize="11" FontWeight="Bold" TextAlignment="Left" />
                                        </Border>
                                        <ikw:SimpleStackPanel Margin="10,4,10,0" Spacing="-2.5">
                                            <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="8"
                                                                 VerticalAlignment="Center"
                                                                 HorizontalAlignment="Center">
                                                <ui:FontIcon Margin="0,4,0,2" Height="20" Width="20" FontSize="16"
                                                             FontFamily="{StaticResource FluentIconFontFamily}"
                                                             Glyph="&#xe716;"
                                                             Foreground="{DynamicResource BoardBarForeground}" />
                                                <Label Content="多指书写" FontSize="12" VerticalAlignment="Center"
                                                       Foreground="{DynamicResource BoardBarForeground}" />
                                                <Viewbox Width="36" Height="25">
                                                    <ui:ToggleSwitch MinWidth="0" Width="42"
                                                                     Name="BoardToggleSwitchEnableMultiTouchMode"
                                                                     IsOn="False" OnContent="" OffContent=""
                                                                     Toggled="ToggleSwitchEnableMultiTouchMode_Toggled"
                                                                     ui:ThemeManager.RequestedTheme="{DynamicResource BoardTheme}"/>
                                                </Viewbox>
                                            </ikw:SimpleStackPanel>
                                            <ikw:SimpleStackPanel
                                                Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}"
                                                x:Name="BoardTwoFingerGestureSimpleStackPanel" Orientation="Horizontal"
                                                Spacing="8" VerticalAlignment="Center" HorizontalAlignment="Center">
                                                <ui:FontIcon Margin="0,4,0,2" Height="20" Width="20" FontSize="16"
                                                             FontFamily="{StaticResource FluentIconFontFamily}"
                                                             Glyph="&#xe7c2;"
                                                             Foreground="{DynamicResource BoardBarForeground}" />
                                                <Label Content="双指移动" FontSize="12" VerticalAlignment="Center"
                                                       Foreground="{DynamicResource BoardBarForeground}" />
                                                <Viewbox Width="36" Height="25">
                                                    <ui:ToggleSwitch MinWidth="0" Width="42" OnContent="" OffContent=""
                                                                     Name="BoardToggleSwitchEnableTwoFingerTranslate"
                                                                     IsOn="False"
                                                                     Toggled="ToggleSwitchEnableTwoFingerTranslate_Toggled"
                                                                     ui:ThemeManager.RequestedTheme="{DynamicResource BoardTheme}"/>
                                                </Viewbox>
                                            </ikw:SimpleStackPanel>
                                            <ikw:SimpleStackPanel
                                                Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}"
                                                Orientation="Horizontal" Spacing="8" VerticalAlignment="Center"
                                                HorizontalAlignment="Center">
                                                <ui:FontIcon Margin="0,4,0,2" Height="20" Width="20" FontSize="16"
                                                             FontFamily="{StaticResource FluentIconFontFamily}"
                                                             Glyph="&#xe740;"
                                                             Foreground="{DynamicResource BoardBarForeground}" />
                                                <Label Content="双指缩放" FontSize="12" VerticalAlignment="Center"
                                                       Foreground="{DynamicResource BoardBarForeground}" />
                                                <Viewbox Width="36" Height="25">
                                                    <ui:ToggleSwitch MinWidth="0" Width="42" OnContent="" OffContent=""
                                                                     Name="BoardToggleSwitchEnableTwoFingerZoom"
                                                                     IsOn="False"
                                                                     Toggled="ToggleSwitchEnableTwoFingerZoom_Toggled"
                                                                     ui:ThemeManager.RequestedTheme="{DynamicResource BoardTheme}"/>
                                                </Viewbox>
                                            </ikw:SimpleStackPanel>
                                            <ikw:SimpleStackPanel
                                                Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}"
                                                Orientation="Horizontal" Spacing="8" VerticalAlignment="Center"
                                                HorizontalAlignment="Center">
                                                <ui:FontIcon Margin="0,4,0,2" Height="20" Width="20" FontSize="16"
                                                             FontFamily="{StaticResource FluentIconFontFamily}"
                                                             Glyph="&#xe7ad;"
                                                             Foreground="{DynamicResource BoardBarForeground}" />
                                                <Label Content="双指旋转" FontSize="12" VerticalAlignment="Center"
                                                       Foreground="{DynamicResource BoardBarForeground}" />
                                                <Viewbox Width="36" Height="25">
                                                    <ui:ToggleSwitch MinWidth="0" Width="42" OnContent="" OffContent=""
                                                                     Name="BoardToggleSwitchEnableTwoFingerRotation"
                                                                     Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled"
                                                                     ui:ThemeManager.RequestedTheme="{DynamicResource BoardTheme}"/>
                                                </Viewbox>
                                            </ikw:SimpleStackPanel>
                                        </ikw:SimpleStackPanel>
                                    </ikw:SimpleStackPanel>
                                </Border>
                            </Viewbox>
                        </Grid>
                        <Border Margin="0,0,5,0" Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="BoardChangeBackgroundColorBtn_MouseUp" CornerRadius="0,5,5,0"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="0 1 1 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon Height="26" Width="26" VerticalAlignment="Top" FontSize="22"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xef1f;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock Text="画布" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border x:Name="BoardSelect" Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="SymbolIconSelect_MouseUp" CornerRadius="5,0,0,5"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="1 1 0.25 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ikw:SimpleStackPanel Width="28" Height="28" VerticalAlignment="Top"
                                                     Background="Transparent" Orientation="Horizontal"
                                                     HorizontalAlignment="Center">
                                    <ui:FontIcon Height="22" Width="28" FontSize="22"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe958;"
                                                 Foreground="{DynamicResource BoardBarForeground}" />
                                    <ui:FontIcon Margin="-24,0,0,-13" Height="22" Width="10" FontSize="14"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf8af;"
                                                 Foreground="{DynamicResource BoardBarForeground}" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="选择" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border x:Name="BoardPen" Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="PenIcon_Click" Background="{DynamicResource BoardBarBackground}"
                                BorderThickness="0 1 0.25 1" BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ikw:SimpleStackPanel x:Name="BoardPenIcon" Width="28" Height="28"
                                                     VerticalAlignment="Top" Background="Transparent"
                                                     Orientation="Horizontal" HorizontalAlignment="Center">
                                    <ui:FontIcon Height="22" Width="28" FontSize="22"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xee56;"
                                                 Foreground="{DynamicResource BoardBarForeground}" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="墨迹" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border>
                            <Grid Width="0">
                                <Border x:Name="BoardPenPalette" Margin="-248,-218,-190,59" Visibility="Visible"
                                        Background="{DynamicResource BoardBarBackground}"
                                        BorderBrush="{DynamicResource BoardBarBorderBrush}" BorderThickness="1"
                                        CornerRadius="5">
                                    <ikw:SimpleStackPanel>
                                        <Border Background="{DynamicResource BoardBarTitleBackground}"
                                                BorderBrush="{DynamicResource BoardBarBorderBrush}" BorderThickness="1"
                                                CornerRadius="5,5,0,0" Margin="-1 -1 -1 0" Padding="15,5">
                                            <TextBlock Text="墨迹选项" Foreground="{DynamicResource BoardBarForeground}"
                                                       FontWeight="Bold" />
                                        </Border>
                                        <ikw:SimpleStackPanel Orientation="Horizontal">
                                            <Viewbox Width="280">
                                                <ikw:SimpleStackPanel Margin="20 10 10 10">
                                                    <Viewbox Height="80" HorizontalAlignment="Center"
                                                             VerticalAlignment="Center">
                                                        <ikw:SimpleStackPanel>
                                                            <Controls:UniformGrid Columns="2" Width="310" Height="55">
                                                                <ikw:SimpleStackPanel Orientation="Horizontal"
                                                                    Height="35">
                                                                    <Label Content="笔锋" Margin="0,0,12,0"
                                                                           Foreground="{DynamicResource BoardBarForeground}"
                                                                           FontSize="15" VerticalAlignment="Center" />
                                                                    <ComboBox Height="30" VerticalAlignment="Center"
                                                                              Name="BoardComboBoxPenStyle"
                                                                              SelectedIndex="0"
                                                                              SelectionChanged="ComboBoxPenStyle_SelectionChanged"
                                                                              ui:ThemeManager.RequestedTheme="{DynamicResource BoardTheme}">
                                                                        <ComboBoxItem Content="点集笔锋" />
                                                                        <ComboBoxItem Content="速率笔锋" />
                                                                        <ComboBoxItem Content="关闭笔锋" />
                                                                    </ComboBox>
                                                                </ikw:SimpleStackPanel>
                                                                <ikw:SimpleStackPanel Margin="0,-5,0,-5"
                                                                    VerticalAlignment="Center"
                                                                    HorizontalAlignment="Right">
                                                                    <ikw:SimpleStackPanel
                                                                        x:Name="BoardNibModeSimpleStackPanel"
                                                                        Orientation="Horizontal" Width="135">
                                                                        <Label Content="笔尖模式" FontSize="15"
                                                                               VerticalAlignment="Center" />
                                                                        <ui:ToggleSwitch
                                                                            x:Name="BoardToggleSwitchEnableNibMode"
                                                                            MinWidth="0" Width="70" OnContent="开"
                                                                            OffContent="关" Margin="10,0,0,0"
                                                                            Toggled="ToggleSwitchEnableNibMode_Toggled"
                                                                            IsOn="True"
                                                                            ui:ThemeManager.RequestedTheme="{DynamicResource BoardTheme}"/>
                                                                    </ikw:SimpleStackPanel>
                                                                    <ikw:SimpleStackPanel Orientation="Horizontal"
                                                                        Width="135">
                                                                        <Label Margin="0,0,10,0" Content="墨迹识别"
                                                                               Foreground="{DynamicResource BoardBarForeground}"
                                                                               FontSize="15" VerticalAlignment="Center" />
                                                                        <ui:ToggleSwitch
                                                                            Foreground="{DynamicResource BoardBarForeground}"
                                                                            Width="70" OnContent="开" OffContent="关"
                                                                            Toggled="ToggleSwitchEnableInkToShape_Toggled"
                                                                            MinWidth="0"
                                                                            IsOn="{Binding ElementName=ToggleSwitchEnableInkToShape, Path=IsOn}"
                                                                            ui:ThemeManager.RequestedTheme="{DynamicResource BoardTheme}"/>
                                                                    </ikw:SimpleStackPanel>
                                                                </ikw:SimpleStackPanel>
                                                            </Controls:UniformGrid>
                                                            <StackPanel Orientation="Horizontal" Height="30">
                                                                <Label Margin="0,0,10,0" Content="粗细"
                                                                       Foreground="{DynamicResource BoardBarForeground}"
                                                                       FontSize="15" VerticalAlignment="Center" />
                                                                <Slider x:Name="BoardInkWidthSlider" Minimum="1"
                                                                        Maximum="30" Width="250" FontSize="20"
                                                                        IsSnapToTickEnabled="True" Value="5"
                                                                        TickFrequency="1" TickPlacement="None"
                                                                        ValueChanged="InkWidthSlider_ValueChanged"
                                                                        ui:ThemeManager.RequestedTheme="{DynamicResource BoardTheme}"/>
                                                                <TextBlock
                                                                    Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                                                                    Foreground="{DynamicResource BoardBarForeground}"
                                                                    VerticalAlignment="Bottom" Margin="10,0,0,8"
                                                                    FontSize="14" />
                                                            </StackPanel>
                                                        </ikw:SimpleStackPanel>
                                                    </Viewbox>
                                                    <ikw:SimpleStackPanel Width="310">
                                                        <Border Width="310" Height="120" BorderBrush="Black"
                                                                BorderThickness="0" CornerRadius="5">
                                                            <Controls:UniformGrid Rows="2" Height="120">
                                                                <ikw:SimpleStackPanel Height="50"
                                                                    Orientation="Horizontal" Width="310">
                                                                    <Controls:UniformGrid Columns="5" Width="310">
                                                                        <Border Background="Transparent"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseDown="Border_MouseDown"
                                                                            MouseUp="ColorThemeSwitch_MouseUp">
                                                                            <Grid Margin="5">
                                                                                <ui:FontIcon
                                                                                    x:Name="BoardColorThemeSwitchIcon1"
                                                                                    VerticalAlignment="Top" Height="26"
                                                                                    Width="26"
                                                                                    FontFamily="{StaticResource FluentIconFontFamily}"
                                                                                    Glyph="&#xe706;"
                                                                                    Foreground="{DynamicResource BoardBarForeground}" />
                                                                                <ui:FontIcon
                                                                                    x:Name="BoardColorThemeSwitchIcon2"
                                                                                    VerticalAlignment="Top" Height="0"
                                                                                    Width="0"
                                                                                    FontFamily="{StaticResource FluentIconFontFamily}"
                                                                                    Glyph="&#xe708;"
                                                                                    Foreground="{DynamicResource BoardBarForeground}" />
                                                                                <TextBlock
                                                                                    x:Name="BoardColorThemeSwitchTextBlock"
                                                                                    Foreground="{DynamicResource BoardBarForeground}"
                                                                                    Text="亮系"
                                                                                    VerticalAlignment="Bottom"
                                                                                    HorizontalAlignment="Center"
                                                                                    FontSize="13" />
                                                                            </Grid>
                                                                        </Border>
                                                                        <Border x:Name="BoardBorderPenColorBlack"
                                                                            Background="Black"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorBlack_Click">
                                                                            <Viewbox
                                                                                Name="BoardViewboxBtnColorBlackContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BoardBorderPenColorWhite"
                                                                            Background="White"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorWhite_Click">
                                                                            <Viewbox
                                                                                x:Name="BoardViewboxBtnColorWhiteContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-black.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BoardBorderPenColorRed"
                                                                            Background="#dc2626"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorRed_Click">
                                                                            <Viewbox
                                                                                Name="BoardViewboxBtnColorRedContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BoardBorderPenColorPink"
                                                                            Background="#c72ec7"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorPink_Click">
                                                                            <Viewbox
                                                                                x:Name="BoardViewboxBtnColorPinkContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                    </Controls:UniformGrid>
                                                                </ikw:SimpleStackPanel>
                                                                <ikw:SimpleStackPanel Height="50"
                                                                    Orientation="Horizontal" Width="310">
                                                                    <Controls:UniformGrid Columns="5" Width="310">
                                                                        <Border x:Name="BoardBorderPenColorOrange"
                                                                            Background="#ea580c"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorOrange_Click">
                                                                            <Viewbox
                                                                                x:Name="BoardViewboxBtnColorOrangeContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BoardBorderPenColorYellow"
                                                                            Background="#eab308"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorYellow_Click">
                                                                            <Viewbox
                                                                                x:Name="BoardViewboxBtnColorYellowContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BoardBorderPenColorGreen"
                                                                            Background="#16a34a"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorGreen_Click">
                                                                            <Viewbox
                                                                                x:Name="BoardViewboxBtnColorGreenContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BoardBorderPenColorTeal"
                                                                            Background="#0d9488"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorTeal_Click">
                                                                            <Viewbox
                                                                                x:Name="BoardViewboxBtnColorTealContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BoardBorderPenColorBlue"
                                                                            Background="#2563eb"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorBlue_Click">
                                                                            <Viewbox
                                                                                x:Name="BoardViewboxBtnColorBlueContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                    </Controls:UniformGrid>
                                                                </ikw:SimpleStackPanel>
                                                            </Controls:UniformGrid>
                                                        </Border>
                                                    </ikw:SimpleStackPanel>
                                                </ikw:SimpleStackPanel>
                                            </Viewbox>
                                            <Viewbox Width="140">
                                                <ikw:SimpleStackPanel Width="115">
                                                    <TextBlock Margin="0,30,0,5" Text="荧光笔"
                                                               Foreground="{DynamicResource BoardBarForeground}"
                                                               FontWeight="Bold" TextAlignment="Center" />

                                                    <ikw:SimpleStackPanel Orientation="Horizontal"
                                                                         VerticalAlignment="Center" Spacing="5">
                                                        <TextBlock Text="不透明度"
                                                                   Foreground="{DynamicResource BoardBarForeground}"
                                                                   FontSize="10" TextAlignment="Left" />
                                                        <Viewbox Height="16">
                                                            <Slider x:Name="BoardInkAlphaSlider" Minimum="20"
                                                                    Maximum="240" Value="120" Width="140"
                                                                    IsSnapToTickEnabled="True" TickFrequency="20"
                                                                    TickPlacement="None"
                                                                    ValueChanged="InkAlphaSlider_ValueChanged"
                                                                    ui:ThemeManager.RequestedTheme="{DynamicResource BoardTheme}"/>
                                                        </Viewbox>
                                                    </ikw:SimpleStackPanel>

                                                    <ikw:SimpleStackPanel>
                                                        <Controls:UniformGrid Rows="2" Height="65">
                                                            <ikw:SimpleStackPanel Height="25" Orientation="Horizontal"
                                                                Width="115">
                                                                <Controls:UniformGrid Columns="3" Width="115">
                                                                    <Border x:Name="BoardBorderHighlighterColorRed"
                                                                            Background="#ff5e53"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1" CornerRadius="4"
                                                                            Width="30"
                                                                            MouseUp="BtnHighlighterColorRed_Click">
                                                                        <Viewbox
                                                                            x:Name="BoardViewboxBtnHighlighterColorRedContent"
                                                                            Visibility="Collapsed" Margin="2">
                                                                            <Image
                                                                                Source="/Resources/Icons-png/checked-white.png"
                                                                                RenderOptions.BitmapScalingMode="HighQuality"
                                                                                VerticalAlignment="Top" Width="28"
                                                                                Height="28" />
                                                                        </Viewbox>
                                                                    </Border>
                                                                    <Border x:Name="BoardBorderHighlighterColorOrange"
                                                                            Background="#ff700d"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1" CornerRadius="4"
                                                                            Width="30"
                                                                            MouseUp="BtnHighlighterColorOrange_Click">
                                                                        <Viewbox
                                                                            Name="BoardViewboxBtnHighlighterColorOrangeContent"
                                                                            Visibility="Collapsed" Margin="2">
                                                                            <Image
                                                                                Source="/Resources/Icons-png/checked-white.png"
                                                                                RenderOptions.BitmapScalingMode="HighQuality"
                                                                                VerticalAlignment="Top" Width="28"
                                                                                Height="28" />
                                                                        </Viewbox>
                                                                    </Border>
                                                                    <Border x:Name="BoardBorderHighlighterColorYellow"
                                                                            Background="#ffd308"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1" CornerRadius="4"
                                                                            Width="30"
                                                                            MouseUp="BtnHighlighterColorYellow_Click">
                                                                        <Viewbox
                                                                            x:Name="BoardViewboxBtnHighlighterColorYellowContent"
                                                                            Visibility="Collapsed" Margin="2">
                                                                            <Image
                                                                                Source="/Resources/Icons-png/checked-white.png"
                                                                                RenderOptions.BitmapScalingMode="HighQuality"
                                                                                VerticalAlignment="Top" Width="28"
                                                                                Height="28" />
                                                                        </Viewbox>
                                                                    </Border>
                                                                </Controls:UniformGrid>
                                                            </ikw:SimpleStackPanel>
                                                            <ikw:SimpleStackPanel Height="25" Orientation="Horizontal"
                                                                Width="115">
                                                                <Controls:UniformGrid Columns="3" Width="115">
                                                                    <Border x:Name="BoardBorderHighlighterColorTeal"
                                                                            Background="#10baab"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1" CornerRadius="4"
                                                                            Width="30"
                                                                            MouseUp="BtnHighlighterColorTeal_Click">
                                                                        <Viewbox
                                                                            x:Name="BoardViewboxBtnHighlighterColorTealContent"
                                                                            Visibility="Collapsed" Margin="2">
                                                                            <Image
                                                                                Source="/Resources/Icons-png/checked-white.png"
                                                                                RenderOptions.BitmapScalingMode="HighQuality"
                                                                                VerticalAlignment="Top" Width="28"
                                                                                Height="28" />
                                                                        </Viewbox>
                                                                    </Border>
                                                                    <Border x:Name="BoardBorderHighlighterColorBlue"
                                                                            Background="#4a76ff"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1" CornerRadius="4"
                                                                            Width="30"
                                                                            MouseUp="BtnHighlighterColorBlue_Click">
                                                                        <Viewbox
                                                                            x:Name="BoardViewboxBtnHighlighterColorBlueContent"
                                                                            Visibility="Collapsed" Margin="2">
                                                                            <Image
                                                                                Source="/Resources/Icons-png/checked-white.png"
                                                                                RenderOptions.BitmapScalingMode="HighQuality"
                                                                                VerticalAlignment="Top" Width="28"
                                                                                Height="28" />
                                                                        </Viewbox>
                                                                    </Border>
                                                                    <Border x:Name="BoardBorderHighlighterColorPurple"
                                                                            Background="#9333ea"
                                                                            BorderBrush="{DynamicResource BoardBarBorderBrush}"
                                                                            BorderThickness="1" CornerRadius="4"
                                                                            Width="30"
                                                                            MouseUp="BtnHighlighterColorPurple_Click">
                                                                        <Viewbox
                                                                            x:Name="BoardViewboxBtnHighlighterColorPurpleContent"
                                                                            Visibility="Collapsed" Margin="2">
                                                                            <Image
                                                                                Source="/Resources/Icons-png/checked-white.png"
                                                                                RenderOptions.BitmapScalingMode="HighQuality"
                                                                                VerticalAlignment="Top" Width="28"
                                                                                Height="28" />
                                                                        </Viewbox>
                                                                    </Border>
                                                                </Controls:UniformGrid>
                                                            </ikw:SimpleStackPanel>
                                                        </Controls:UniformGrid>
                                                    </ikw:SimpleStackPanel>


                                                </ikw:SimpleStackPanel>
                                            </Viewbox>
                                        </ikw:SimpleStackPanel>
                                    </ikw:SimpleStackPanel>
                                </Border>
                            </Grid>
                        </Border>
                        <Border x:Name="BoardEraser" Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="BoardEraserIcon_Click" Background="{DynamicResource BoardBarBackground}"
                                BorderThickness="0 1 0.25 1" BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ikw:SimpleStackPanel Width="28" Height="28" VerticalAlignment="Top"
                                                     Background="Transparent" Orientation="Horizontal"
                                                     HorizontalAlignment="Center">
                                    <ui:FontIcon Height="22" Width="28" FontSize="22"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe75c;"
                                                 Foreground="{DynamicResource BoardBarForeground}" />
                                    <ui:FontIcon Margin="-23,0,0,-10" Height="22" Width="20" FontSize="16"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf0b6;"
                                                 Foreground="{DynamicResource BoardBarForeground}" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="面积擦" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border Width="0" MouseDown="Border_MouseDown" MouseUp="BoardSymbolIconDelete_MouseUp">
                            <Border x:Name="BoardDeleteIcon" Margin="-61,-55,-61,55"
                                    Background="{DynamicResource BoardBarBackground}"
                                    BorderBrush="{DynamicResource BoardBarBorderBrush}" BorderThickness="1,1,1,0"
                                    CornerRadius="5,5,0,0">
                                <Grid>
                                    <ikw:SimpleStackPanel Margin="5" Orientation="Horizontal"
                                                         HorizontalAlignment="Center">
                                        <ui:FontIcon Height="22" Width="28" FontSize="22"
                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                     Glyph="&#xe74d;" Foreground="{DynamicResource BoardBarForeground}" />
                                        <TextBlock Margin="5,0,0,0" Text="点击清屏"
                                                   Foreground="{DynamicResource BoardBarForeground}"
                                                   VerticalAlignment="Center" FontSize="14" />
                                    </ikw:SimpleStackPanel>
                                </Grid>
                            </Border>
                        </Border>
                        <Border x:Name="BoardEraserByStrokes" Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="BoardEraserIconByStrokes_Click"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="0 1 0.25 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ikw:SimpleStackPanel Width="28" Height="28" VerticalAlignment="Top"
                                                     Background="Transparent" Orientation="Horizontal"
                                                     HorizontalAlignment="Center">
                                    <ui:FontIcon Height="22" Width="28" FontSize="22"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe75c;"
                                                 Foreground="{DynamicResource BoardBarForeground}" />
                                    <ui:FontIcon Margin="-14,0,0,-10.5" Height="22" Width="10" FontSize="12"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf128;"
                                                 Foreground="{DynamicResource BoardBarForeground}" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="墨迹擦" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border x:Name="BoardGeometry" Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="ImageDrawShape_MouseUp" Background="{DynamicResource BoardBarBackground}"
                                BorderThickness="0 1 0.25 1" BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ikw:SimpleStackPanel Width="28" Height="28" VerticalAlignment="Top"
                                                     Background="Transparent" Orientation="Horizontal"
                                                     HorizontalAlignment="Center">
                                    <ui:FontIcon Height="22" Width="28" FontSize="22"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf158;"
                                                 Foreground="{DynamicResource BoardBarForeground}" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="图形" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border Width="0">
                            <Border x:Name="BoardBorderDrawShape" Visibility="Visible"
                                    Background="{DynamicResource BoardBarBackground}"
                                    BorderBrush="{DynamicResource BoardBarBorderBrush}" BorderThickness="1"
                                    CornerRadius="5" Margin="-162,-293,-89,58">
                                <ikw:SimpleStackPanel Orientation="Vertical">
                                    <Border Background="{DynamicResource BoardBarTitleBackground}"
                                            BorderBrush="{DynamicResource BoardBarBorderBrush}" BorderThickness="1"
                                            CornerRadius="5,5,0,0" Margin="-1 -1 -1 0" Padding="15,5,0,5">
                                        <ikw:SimpleStackPanel Orientation="Horizontal">
                                            <TextBlock Text="图形(第一行支持长按保持选中)" FontSize="14"
                                                       Foreground="{DynamicResource BoardBarForeground}"
                                                       FontWeight="Bold" />
                                            <ui:SymbolIcon Margin="10 0 0 0" FontSize="16" Symbol="Pin"
                                                           MouseDown="Border_MouseDown"
                                                           MouseUp="SymbolIconPinBorderDrawShape_MouseUp"
                                                           Foreground="{DynamicResource BoardBarForeground}"
                                                           HorizontalAlignment="Right" />
                                        </ikw:SimpleStackPanel>
                                    </Border>
                                    <Viewbox Margin="0,10,0,0" Width="240">
                                        <ikw:SimpleStackPanel Spacing="-8">
                                            <ikw:SimpleStackPanel Height="50" Spacing="14" Orientation="Horizontal">
                                                <Image x:Name="BoardImageDrawLine" Margin="16,12,0,12"
                                                       MouseDown="Image_MouseDown" MouseUp="BtnDrawLine_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Line}" />
                                                <Image x:Name="BoardImageDrawDashedLine" Margin="0,12,0,12"
                                                       MouseDown="Image_MouseDown" MouseUp="BtnDrawDashedLine_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.DashedLine}" />
                                                <Image x:Name="BoardImageDrawDotLine" Margin="0,12,0,12"
                                                       MouseDown="Image_MouseDown" MouseUp="BtnDrawDotLine_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.DotLine}" />
                                                <Image x:Name="BoardImageDrawArrow" Margin="0,12,0,12"
                                                       MouseDown="Image_MouseDown" MouseUp="BtnDrawArrow_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.ArrowLine}" />
                                                <Image x:Name="BoardImageDrawParallelLine" Margin="0,11.5,16,11.5"
                                                       MouseDown="Image_MouseDown" MouseUp="BtnDrawParallelLine_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.ParallelLine}" />
                                            </ikw:SimpleStackPanel>
                                            <ikw:SimpleStackPanel Height="50" Spacing="15" Orientation="Horizontal">
                                                <Image Margin="16,12,0,12" MouseUp="BtnDrawCoordinate1_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Coordinate1}" />
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate2_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Coordinate2}" />
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate3_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Coordinate3}" />
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate4_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Coordinate4}" />
                                                <Image Margin="-1,11.5" MouseUp="BtnDrawCoordinate5_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Coordinate5}" />
                                            </ikw:SimpleStackPanel>
                                            <ikw:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="16,11,2,11" MouseUp="BtnDrawRectangleCenter_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.RectangleCenter}" />
                                                <Image Visibility="Collapsed" Margin="0,10"
                                                       MouseUp="BtnDrawEllipse_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Ellipse}" />
                                                <Image Margin="0,10" MouseUp="BtnDrawCircle_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Circle}" />
                                                <Image Margin="0,10" MouseUp="BtnDrawDashedCircle_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.DashedCircle}" />
                                                <Image Margin="0,10" MouseUp="BtnDrawCenterEllipse_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.EllipseCenter}"
                                                       Width="30" />
                                                <Image Margin="0,10" MouseUp="BtnDrawCenterEllipseWithFocalPoint_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.EllipseCenterWithFocalPoint}"
                                                       Width="30" />
                                            </ikw:SimpleStackPanel>
                                            <ikw:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="16,10,2,10" MouseUp="BtnDrawHyperbola_Click" Width="26"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Hyperbola}" />
                                                <Image Margin="4,10,2,10"
                                                       MouseUp="BtnDrawHyperbolaWithFocalPoint_Click" Width="26"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.HyperbolaWithFocalPoint}" />
                                                <Image Margin="2.5,10,2,10" MouseUp="BtnDrawParabola1_Click" Width="26"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Parabola}" />
                                                <Image Margin="1,10,2,10" MouseUp="BtnDrawParabolaWithFocalPoint_Click"
                                                       Width="26"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.ParabolaWithFocalPoint}"
                                                       RenderTransformOrigin="0.5,0.5">
                                                    <Image.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform />
                                                            <SkewTransform />
                                                            <RotateTransform Angle="90" />
                                                            <TranslateTransform />
                                                        </TransformGroup>
                                                    </Image.RenderTransform>
                                                </Image>
                                                <Image Margin="2,10,2,10" MouseUp="BtnDrawParabola2_Click" Width="26"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Parabola}"
                                                       RenderTransformOrigin="0.5,0.5">
                                                    <Image.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform />
                                                            <SkewTransform />
                                                            <RotateTransform Angle="90" />
                                                            <TranslateTransform />
                                                        </TransformGroup>
                                                    </Image.RenderTransform>
                                                </Image>
                                            </ikw:SimpleStackPanel>
                                            <ikw:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="15,11,2,11" MouseUp="BtnDrawRectangle_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Rectangle}" />
                                                <Image Margin="6,10,2,10" MouseUp="BtnDrawCylinder_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Cylinder}" />
                                                <Image Margin="8,12.5,0,10" MouseUp="BtnDrawCone_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Cone}" />
                                                <Image Margin="5.5,12.5,2.5,10" MouseUp="BtnDrawCuboid_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Cuboid}" />
                                                <Image Visibility="Collapsed" Margin="0,11.5,2.5,9.5"
                                                       MouseUp="BtnDrawCuboid_Click"
                                                       Source="{DynamicResource BoardDrawShapeImageSource.Tetrahedron}" />
                                            </ikw:SimpleStackPanel>
                                        </ikw:SimpleStackPanel>
                                    </Viewbox>
                                </ikw:SimpleStackPanel>
                            </Border>
                        </Border>
                        <Border x:Name="BoardUndo" Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="SymbolIconUndo_MouseUp"
                                IsEnabled="{Binding ElementName=BtnUndo, Path=IsEnabled}"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="0 1 0.25 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ikw:SimpleStackPanel Width="28" Height="28" VerticalAlignment="Top"
                                                     Background="Transparent" Orientation="Horizontal"
                                                     HorizontalAlignment="Center">
                                    <ui:FontIcon Height="22" Width="28" FontSize="22"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe7a7;"
                                                 Foreground="{DynamicResource BoardBarForeground}"
                                                 Opacity="{Binding ElementName=BtnUndo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="撤销" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"
                                           Opacity="{Binding ElementName=BtnUndo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}" />
                            </Grid>
                        </Border>
                        <Border x:Name="BoardRedo" Width="60" Height="55" CornerRadius="0,5,5,0"
                                MouseDown="Border_MouseDown" MouseUp="SymbolIconRedo_MouseUp"
                                IsEnabled="{Binding ElementName=BtnRedo, Path=IsEnabled}"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="0 1 1 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ikw:SimpleStackPanel Width="28" Height="28" VerticalAlignment="Top"
                                                     Background="Transparent" Orientation="Horizontal"
                                                     HorizontalAlignment="Center">
                                    <ui:FontIcon Height="22" Width="28" FontSize="22"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe7a6;"
                                                 Foreground="{DynamicResource BoardBarForeground}"
                                                 Opacity="{Binding ElementName=BtnRedo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="重做" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"
                                           Opacity="{Binding ElementName=BtnRedo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}" />
                            </Grid>
                        </Border>
                        <Border Margin="5,0,0,0" Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="SymbolIconTools_MouseUp" Background="{DynamicResource BoardBarBackground}"
                                CornerRadius="5,0,0,5" BorderThickness="1 1 0.25 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon Height="26" Width="26" VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe8a9;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock Text="更多" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border>
                            <Grid Margin="0,0,0,5" Width="0">
                                <Border Name="BoardBorderTools" Margin="-160,-254,-80,60" CornerRadius="5"
                                        Background="{DynamicResource BoardBarBackground}" BorderThickness="1"
                                        BorderBrush="{DynamicResource BoardBarBorderBrush}">
                                    <ikw:SimpleStackPanel>
                                        <Border Background="{DynamicResource BoardBarTitleBackground}"
                                                BorderBrush="{DynamicResource BoardBarBorderBrush}" BorderThickness="1"
                                                CornerRadius="5,5,0,0" Margin="-1 -1 -1 0" Padding="15,5">
                                            <TextBlock Text="更多功能" FontSize="16"
                                                       Foreground="{DynamicResource BoardBarForeground}"
                                                       FontWeight="Bold" />
                                        </Border>
                                        <Viewbox Margin="0,5,0,0" Width="180" Height="150">
                                            <ikw:SimpleStackPanel HorizontalAlignment="Center" Spacing="0">
                                                <ikw:SimpleStackPanel Height="40" Spacing="8" Orientation="Horizontal">
                                                    <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                         MouseUp="ImageCountdownTimer_MouseUp"
                                                                         Height="40" Width="40" Orientation="Vertical">
                                                        <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                                     Glyph="&#xea8f;"
                                                                     Foreground="{DynamicResource BoardBarForeground}" />
                                                        <Label Content="倒计时" FontSize="10" HorizontalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                    </ikw:SimpleStackPanel>
                                                    <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                         MouseUp="SymbolIconRand_MouseUp" Height="40"
                                                                         Width="40" Orientation="Vertical">
                                                        <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                                     Glyph="&#xe8b1;"
                                                                     Foreground="{DynamicResource BoardBarForeground}" />
                                                        <Label Content="随机抽选" FontSize="10"
                                                               HorizontalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                    </ikw:SimpleStackPanel>
                                                    <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                         MouseUp="SymbolIconRandOne_MouseUp"
                                                                         Height="40" Width="40" Orientation="Vertical">
                                                        <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                                     Glyph="&#xe8b1;"
                                                                     Foreground="{DynamicResource BoardBarForeground}" />
                                                        <Border CornerRadius="50"
                                                                BorderBrush="{DynamicResource BoardBarForeground}"
                                                                BorderThickness="1" HorizontalAlignment="Center"
                                                                Margin="-2,-10,0,-2" VerticalAlignment="Bottom"
                                                                Height="9" Width="9">
                                                            <TextBlock Text="1" FontSize="7"
                                                                       HorizontalAlignment="Center"
                                                                       VerticalAlignment="Top" Margin="0,-0.8,0,0"
                                                                       Foreground="{DynamicResource BoardBarForeground}" />
                                                        </Border>
                                                        <Label Content="单次抽选" FontSize="10"
                                                               HorizontalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                    </ikw:SimpleStackPanel>
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel Height="40" Spacing="8" Orientation="Horizontal">
                                                    <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                         MouseUp="SymbolIconSaveStrokes_MouseUp"
                                                                         Height="40" Width="40" Orientation="Vertical">
                                                        <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                                     Glyph="&#xe74e;"
                                                                     Foreground="{DynamicResource BoardBarForeground}" />
                                                        <Label Content="保存墨迹" FontSize="10"
                                                               HorizontalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                    </ikw:SimpleStackPanel>
                                                    <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                         MouseUp="SymbolIconOpenStrokes_MouseUp"
                                                                         Height="40" Width="40" Orientation="Vertical">
                                                        <ui:FontIcon Margin="0,4,-2,2" Height="22" Width="22"
                                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                                     Glyph="&#xed25;"
                                                                     Foreground="{DynamicResource BoardBarForeground}" />
                                                        <Label Content="打开墨迹" FontSize="10"
                                                               HorizontalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                    </ikw:SimpleStackPanel>
                                                    <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                         MouseUp="GridInkReplayButton_MouseUp"
                                                                         Height="40" Width="40" Orientation="Vertical">
                                                        <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                                     Glyph="&#xec57;"
                                                                     Foreground="{DynamicResource BoardBarForeground}" />
                                                        <Label Content="播放墨迹" FontSize="10"
                                                               HorizontalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                    </ikw:SimpleStackPanel>
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel Height="40" Spacing="8" Orientation="Horizontal">
                                                    <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                         MouseUp="SymbolIconScreenshot_MouseUp"
                                                                         Height="40" Width="40" Orientation="Vertical">
                                                        <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                                     Glyph="&#xe722;"
                                                                     Foreground="{DynamicResource BoardBarForeground}" />
                                                        <Label Content="截屏" FontSize="10" HorizontalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                    </ikw:SimpleStackPanel>
                                                    <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                         MouseUp="OperatingGuideWindowIcon_MouseUp"
                                                                         Height="40" Width="40" Orientation="Vertical">
                                                        <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                                     Glyph="&#xe82d;"
                                                                     Foreground="{DynamicResource BoardBarForeground}" />
                                                        <Label Content="指南" FontSize="10" HorizontalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                    </ikw:SimpleStackPanel>
                                                    <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                         MouseUp="SymbolIconSettings_Click" Height="40"
                                                                         Width="40" Orientation="Vertical">
                                                        <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                     FontFamily="{StaticResource FluentIconFontFamily}"
                                                                     Glyph="&#xe713;"
                                                                     Foreground="{DynamicResource BoardBarForeground}" />
                                                        <Label Content="设置" FontSize="10" HorizontalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                    </ikw:SimpleStackPanel>
                                                </ikw:SimpleStackPanel>
                                            </ikw:SimpleStackPanel>
                                        </Viewbox>
                                        <Border Margin="4,6,4,0" BorderBrush="{DynamicResource BoardBarForeground}"
                                                BorderThickness="1.5" Width="205" CornerRadius="5">
                                            <ikw:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center"
                                                                 HorizontalAlignment="Center">
                                                <ikw:SimpleStackPanel Orientation="Horizontal"
                                                                     HorizontalAlignment="Center" Margin="2.5,0,0,0"
                                                                     Height="35" Spacing="5"
                                                                     MouseDown="Border_MouseDown"
                                                                     MouseUp="BoardLaunchEasiCamera_MouseUp">
                                                    <Image Source="/Resources/Icons-png/EasiCamera.png"
                                                           RenderOptions.BitmapScalingMode="HighQuality" Height="25"
                                                           Width="25" />
                                                    <TextBlock Text="视频展台" FontSize="12.5" VerticalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                                <Line Margin="10,0" HorizontalAlignment="Center"
                                                      VerticalAlignment="Center" X1="0" Y1="0" X2="0" Y2="25"
                                                      Stroke="{DynamicResource BoardBarForeground}" StrokeThickness="1" />
                                                <ikw:SimpleStackPanel Orientation="Horizontal"
                                                                     HorizontalAlignment="Center" Margin="2.5,0,0,0"
                                                                     Height="35" Spacing="5"
                                                                     MouseDown="Border_MouseDown"
                                                                     MouseUp="BoardLaunchDesmos_MouseUp">
                                                    <Image Margin="-1,0,0,0" Source="/Resources/Icons-png/Desmos.png"
                                                           RenderOptions.BitmapScalingMode="HighQuality" Height="25"
                                                           Width="25">
                                                        <Image.Clip>
                                                            <EllipseGeometry Center="12.5,12.5" RadiusX="12.5"
                                                                             RadiusY="12.5" />
                                                        </Image.Clip>
                                                    </Image>
                                                    <TextBlock Text="Desmos" FontSize="12.5" VerticalAlignment="Center"
                                                               Foreground="{DynamicResource BoardBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                            </ikw:SimpleStackPanel>
                                        </Border>
                                    </ikw:SimpleStackPanel>
                                </Border>
                            </Grid>
                        </Border>
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="ImageBlackboard_MouseUp"
                                CornerRadius="0,5,5,0" Background="{DynamicResource BoardBarBackground}"
                                BorderThickness="0 1 1 1" BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon Height="26" Width="26" VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe944;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock Text="退出" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                    </ikw:SimpleStackPanel>
                </Grid>
            </Viewbox>
            <!-- 右下角 -->
            <Viewbox x:Name="ViewboxBlackboardRightSide" Margin="3,0,0,0" Height="55" HorizontalAlignment="Right"
                     VerticalAlignment="Bottom">
                <Viewbox.LayoutTransform>
                    <ScaleTransform x:Name="ViewboxBlackboardRightSideScaleTransform" ScaleX="1" ScaleY="1" />
                </Viewbox.LayoutTransform>
                <Grid x:Name="BlackboardRightSide" Visibility="Visible" Opacity="0.75" Margin="0,0,3,0" Height="55"
                      HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ikw:SimpleStackPanel Orientation="Horizontal">
                        <Border Margin="0,0,5,0" Width="55" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="BtnWhiteBoardAdd_Click" CornerRadius="3"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon Height="26" Width="26" VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xecc8;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock Text="加页" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="BtnWhiteBoardSwitchPrevious_Click" CornerRadius="3,0,0,3"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="1 1 0.25 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon Height="26" Width="26" VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe760;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock Text="上一页" Foreground="{DynamicResource BoardBarForeground}"
                                           VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                        <Border Width="58" Height="55" Background="{DynamicResource BoardBarBackground}"
                                BorderThickness="0 1 0.25 1" BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="0,5">
                                <ikw:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Margin="0,4,0,2"
                                               Text="{Binding ElementName=TextBlockWhiteBoardIndexInfo, Path=Text}"
                                               Foreground="{DynamicResource BoardBarForeground}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="15" />
                                    <TextBlock Margin="0,3,0,0" Text="页码"
                                               Foreground="{DynamicResource BoardBarForeground}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="12" />
                                </ikw:SimpleStackPanel>
                            </Grid>
                        </Border>
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown"
                                MouseUp="BtnWhiteBoardSwitchNext_Click" CornerRadius="0,5,5,0"
                                Background="{DynamicResource BoardBarBackground}" BorderThickness="0 1 1 1"
                                BorderBrush="{DynamicResource BoardBarBorderBrush}">
                            <Grid Margin="5">
                                <ui:FontIcon Height="26"
                                             Width="{Binding ElementName=BoardLeftPannelNextPage1,Path=Width}"
                                             VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xecc8;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <ui:FontIcon Height="26"
                                             Width="{Binding ElementName=BoardLeftPannelNextPage2,Path=Width}"
                                             VerticalAlignment="Top" FontSize="24"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe761;"
                                             Foreground="{DynamicResource BoardBarForeground}" />
                                <TextBlock Text="{Binding ElementName=BoardLeftPannelNextPageTextBlock, Path=Text}"
                                           Foreground="{DynamicResource BoardBarForeground}" VerticalAlignment="Bottom"
                                           HorizontalAlignment="Center" FontSize="12" />
                            </Grid>
                        </Border>
                    </ikw:SimpleStackPanel>
                </Grid>
            </Viewbox>

            <ikw:SimpleStackPanel Spacing="10" Orientation="Horizontal"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Right"
                                 Height="50" Margin="10"
                                 Visibility="Collapsed">
                <Button Name="BtnWhiteBoardAdd"
                        Width="50" Height="48" FontSize="26" Click="BtnWhiteBoardAdd_Click"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}">
                    <ui:SymbolIcon Symbol="Add" />
                </Button>
                <Button Name="BtnWhiteBoardSwitchPrevious" FontFamily="Symbol"
                        Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchPrevious_Click"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        VerticalContentAlignment="Center"
                        IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform />
                                <SkewTransform />
                                <RotateTransform Angle="-90" />
                                <TranslateTransform />
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}"
                                                             Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Border Height="48" CornerRadius="2" Margin="3,0">
                    <TextBlock Name="TextBlockWhiteBoardIndexInfo"
                               Text="1 / 1"
                               Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                               VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="18" />
                </Border>
                <Button Name="BtnWhiteBoardSwitchNext" FontFamily="Symbol"
                        Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchNext_Click"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        VerticalContentAlignment="Center"
                        IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform />
                                <SkewTransform />
                                <RotateTransform Angle="90" />
                                <TranslateTransform />
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}"
                                                             Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Button Name="BtnWhiteBoardDelete" Click="BtnWhiteBoardDelete_Click"
                        Width="50" Height="48" FontSize="26"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False">
                    <ui:SymbolIcon Symbol="Delete" />
                </Button>
            </ikw:SimpleStackPanel>
        </Grid>

        <!--// 设置界面 //-->
        <Border Name="BorderSettings" Background="White" BorderBrush="Black"
                BorderThickness="1" CornerRadius="5" ui:ThemeManager.RequestedTheme="Light"
                Width="440" HorizontalAlignment="Center" Margin="0,150,0,350" Visibility="Visible">
            <Grid>
                <ui:ScrollViewerEx Margin="0,60,0,50" VerticalScrollBarVisibility="Auto"
                                   PanningMode="VerticalOnly" ui:ThemeManager.RequestedTheme="Light"
                                   ManipulationBoundaryFeedback="SCManipulationBoundaryFeedback">
                    <StackPanel Margin="20,20,20,20">

                        <Border Margin="0,0,0,10" Height="100" CornerRadius="5" BorderBrush="Black" BorderThickness="1">
                            <ikw:SimpleStackPanel VerticalAlignment="Center">
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="15"
                                           Margin="0,0,0,10" Text="设置更改将自动保存，部分设置需要重启软件后生效" />
                                <ikw:SimpleStackPanel Spacing="5">
                                    <ikw:SimpleStackPanel Spacing="5" Orientation="Horizontal"
                                                         HorizontalAlignment="Center">
                                        <Button Width="116" Height="45" Click="BtnRestart_Click">
                                            <ikw:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center"
                                                                 HorizontalAlignment="Center" Spacing="0">
                                                <Image
                                                    Source="/Resources/Icons-png/ic_fluent_arrow_clockwise_24_regular.png"
                                                    RenderOptions.BitmapScalingMode="HighQuality" Height="20"
                                                    Width="26" />
                                                <Label FontSize="16" VerticalAlignment="Center" FontWeight="Bold">重启软件</Label>
                                            </ikw:SimpleStackPanel>
                                        </Button>
                                        <Button Width="116" Height="45" FontWeight="Bold"
                                                Click="BtnResetToSuggestion_Click">
                                            <ikw:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center"
                                                                 HorizontalAlignment="Center" Spacing="0">
                                                <Image
                                                    Source="/Resources/Icons-png/ic_fluent_calendar_sync_24_regular.png"
                                                    RenderOptions.BitmapScalingMode="HighQuality" Height="20"
                                                    Width="26" />
                                                <Label Margin="2,0,0,0" FontSize="16" VerticalAlignment="Center"
                                                       FontWeight="Bold">
                                                    重置设置
                                                </Label>
                                            </ikw:SimpleStackPanel>
                                        </Button>
                                        <Button Width="116" Height="45" Click="BtnExit_Click">
                                            <ikw:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center"
                                                                 HorizontalAlignment="Center" Spacing="0">
                                                <Image Source="/Resources/Icons-png/ic_fluent_power_24_regular.png"
                                                       RenderOptions.BitmapScalingMode="HighQuality" Height="20"
                                                       Width="26" />
                                                <Label FontSize="16" VerticalAlignment="Center" FontWeight="Bold">关闭软件</Label>
                                            </ikw:SimpleStackPanel>
                                        </Button>
                                    </ikw:SimpleStackPanel>
                                </ikw:SimpleStackPanel>
                            </ikw:SimpleStackPanel>
                        </Border>
                        <GroupBox>
                            <GroupBox.Header>
                                <TextBlock Text="启动选项" FontWeight="Bold" Foreground="#18181b" FontSize="26" />
                            </GroupBox.Header>
                            <ikw:SimpleStackPanel Spacing="5">
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="自动检查更新" VerticalAlignment="Center" FontSize="14" Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchIsAutoUpdate" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchIsAutoUpdate_Toggled" />
                                </ikw:SimpleStackPanel>
                                <Border BorderBrush="Black" BorderThickness="1" CornerRadius="5" Padding="12">
                                    <ikw:SimpleStackPanel Spacing="12">
                                        <TextBlock
                                            Text="# 开启 自动检查更新 后，将在软件启动时检查版本号，若版本号落后则会尝试从 Github 下载最新版安装包，安装新版本后会自动删除安装包。更新代理设置文本框放空即为直接裸连 Github。"
                                            TextWrapping="Wrap" Foreground="#666666" />
                                        <ikw:SimpleStackPanel Orientation="Horizontal">
                                            <TextBlock Text="代理设置" VerticalAlignment="Center" FontSize="14"
                                                       Margin="0,0,14,0" />
                                            <ui:ToggleSwitch Name="ToggleSwitchIsAutoUpdateWithProxy" OnContent="开"
                                                             OffContent="关"
                                                             Toggled="ToggleSwitchIsAutoUpdateWithProxy_Toggled" />
                                        </ikw:SimpleStackPanel>
                                        <TextBlock x:Name="AutoUpdateWithProxy_Title" Text="更新代理设置" FontSize="15"
                                                   FontWeight="Bold" TextWrapping="Wrap" Foreground="Black" />
                                        <TextBox x:Name="AutoUpdateProxyTextBox"
                                                 Visibility="{Binding ElementName=AutoUpdateWithProxy_Title, Path=Visibility}"
                                                 Text="https://mirror.ghproxy.com/" TextWrapping="Wrap"
                                                 TextChanged="AutoUpdateProxyTextBox_TextChanged" />
                                        <Grid
                                            Visibility="{Binding ElementName=AutoUpdateWithProxy_Title, Path=Visibility}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <Button Padding="15 7.5" Content="设置代理为 GHProxy"
                                                        Click="BtnResetAutoUpdateProxyToGHProxy_Click" />
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" Orientation="Horizontal"
                                                        HorizontalAlignment="Right">
                                                <Button Padding="15 7.5" Content="检查代理返回数据"
                                                        Click="BtnCheckAutoUpdateProxyReturnedData_Click" />
                                            </StackPanel>
                                        </Grid>
                                        <TextBlock
                                            Visibility="{Binding ElementName=AutoUpdateWithProxy_Title, Path=Visibility}"
                                            Text='# 正确的代理返回数据应为三位版本号，例如 "4.0.0"。' TextWrapping="Wrap"
                                            Foreground="#666666" />
                                        <TextBlock
                                            Visibility="{Binding ElementName=AutoUpdateWithProxy_Title, Path=Visibility}"
                                            Text='# 检查代理返回数据具有一定延迟，弹窗内容为空即无返回数据。' TextWrapping="Wrap"
                                            Foreground="#666666" />
                                    </ikw:SimpleStackPanel>
                                </Border>
                                <ikw:SimpleStackPanel x:Name="IsAutoUpdateWithSilenceBlock" Orientation="Horizontal">
                                    <TextBlock Text="静默更新" VerticalAlignment="Center" FontSize="14" Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchIsAutoUpdateWithSilence" OnContent="开"
                                                     OffContent="关"
                                                     Toggled="ToggleSwitchIsAutoUpdateWithSilence_Toggled" />
                                </ikw:SimpleStackPanel>
                                <Border BorderBrush="Black" BorderThickness="1" CornerRadius="5" Padding="12"
                                        Visibility="{Binding ElementName=IsAutoUpdateWithSilenceBlock, Path=Visibility}">
                                    <ikw:SimpleStackPanel Spacing="12">
                                        <TextBlock
                                            Text="# 关闭静默更新后，已完成安装包的下载后将会弹窗询问是否进行更新，开启静默更新后将会在安装包下载完成后每隔十分钟进行如下检测：①处于静默更新时间段内 ②未处于书写模式 ③未处于画板内。若以上检测通过即会关闭软件进行自动更新。"
                                            TextWrapping="Wrap" Foreground="#666666" />
                                        <ikw:SimpleStackPanel x:Name="AutoUpdateTimePeriodBlock" Spacing="12">
                                            <ikw:SimpleStackPanel Spacing="12">
                                                <TextBlock Text="静默更新时间段" FontSize="15" FontWeight="Bold"
                                                           TextWrapping="Wrap" Foreground="Black" />
                                                <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="12">
                                                    <ikw:SimpleStackPanel Orientation="Horizontal">
                                                        <TextBlock Margin="0,0,10,0" VerticalAlignment="Center"
                                                                   Text="起始时间" FontSize="14" TextWrapping="Wrap"
                                                                   Foreground="Black" />
                                                        <ComboBox x:Name="AutoUpdateWithSilenceStartTimeComboBox"
                                                                  Width="90"
                                                                  SelectionChanged="AutoUpdateWithSilenceStartTimeComboBox_SelectionChanged" />
                                                    </ikw:SimpleStackPanel>
                                                    <ikw:SimpleStackPanel Orientation="Horizontal">
                                                        <TextBlock Margin="0,0,10,0" VerticalAlignment="Center"
                                                                   Text="终止时间" FontSize="14" TextWrapping="Wrap"
                                                                   Foreground="Black" />
                                                        <ComboBox x:Name="AutoUpdateWithSilenceEndTimeComboBox"
                                                                  Width="90"
                                                                  SelectionChanged="AutoUpdateWithSilenceEndTimeComboBox_SelectionChanged" />
                                                    </ikw:SimpleStackPanel>
                                                </ikw:SimpleStackPanel>
                                                <TextBlock Width="340"
                                                           Text="# 若终止时间小于起始时间，即将终止时间视为第二天的时间。# 若起始时间与终止时间相同，即视为全天候时间。"
                                                           TextWrapping="Wrap" Foreground="#666666" />
                                            </ikw:SimpleStackPanel>
                                        </ikw:SimpleStackPanel>
                                    </ikw:SimpleStackPanel>
                                </Border>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="开机时运行" VerticalAlignment="Center" FontSize="14" Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchRunAtStartup" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchRunAtStartup_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="开机运行后收纳到侧边栏" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchFoldAtStartup" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchFoldAtStartup_Toggled" />
                                </ikw:SimpleStackPanel>
                            </ikw:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox>
                            <GroupBox.Header>
                                <TextBlock Text="画板选项" FontWeight="Bold" Foreground="#18181b" FontSize="26" />
                            </GroupBox.Header>
                            <ikw:SimpleStackPanel Spacing="5">
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="显示画笔光标" VerticalAlignment="Center" FontSize="14" Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchShowCursor" IsOn="False" OnContent="开"
                                                     OffContent="关" Toggled="ToggleSwitchShowCursor_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="橡皮大小" FontSize="14" />
                                <ComboBox Name="ComboBoxEraserSize" SelectedIndex="2"
                                          SelectionChanged="ComboBoxEraserSize_SelectionChanged">
                                    <ComboBoxItem Content="小" />
                                    <ComboBoxItem Content="较小" />
                                    <ComboBoxItem Content="中（默认）" />
                                    <ComboBoxItem Content="较大" />
                                    <ComboBoxItem Content="大" />
                                </ComboBox>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="退出画板模式后隐藏墨迹" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchHideStrokeWhenSelecting" IsOn="False"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchHideStrokeWhenSelecting_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="# 开启 退出画板模式后隐藏墨迹 选项后，进入 PPT 模式时未处于批注模式时不会显示墨迹。" TextWrapping="Wrap"
                                           Foreground="#666666" />
                                <TextBlock Text="保留双曲线渐近线" FontSize="14" />
                                <ComboBox Name="ComboBoxHyperbolaAsymptoteOption" SelectedIndex="0"
                                          SelectionChanged="ComboBoxHyperbolaAsymptoteOption_SelectionChanged">
                                    <ComboBoxItem Content="是" />
                                    <ComboBoxItem Content="否" />
                                    <ComboBoxItem Content="每次询问" />
                                </ComboBox>
                                <TextBlock Text="# 请注意，若不保留双曲线渐近线可能会有遇到撤回相关的 BUG 影响用。" TextWrapping="Wrap"
                                           Foreground="#666666" />
                            </ikw:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox>
                            <GroupBox.Header>
                                <TextBlock Text="手势选项" FontWeight="Bold" Foreground="#18181b" FontSize="26" />
                            </GroupBox.Header>
                            <ikw:SimpleStackPanel Spacing="5">
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="自动开关两指缩放功能" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoSwitchTwoFingerGesture" IsOn="True"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoSwitchTwoFingerGesture_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="# 开启 自动开关两指缩放功能 后退出画板模式时自动关闭双指移动手势，进入画板模式时自动开启双指移动手势"
                                           TextWrapping="Wrap" Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="允许双指旋转选中的墨迹" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerRotationOnSelection"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="# 允许选中墨迹后对墨迹进行双指或多指缩放操作（此设置不受“允许双指旋转”设置的影响）" TextWrapping="Wrap"
                                           Foreground="#666666" />
                            </ikw:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxInkRecognition">
                            <GroupBox.Header>
                                <TextBlock Text="墨迹识别选项" FontWeight="Bold" Foreground="#18181b" FontSize="26" />
                            </GroupBox.Header>
                            <ikw:SimpleStackPanel Spacing="5">
                                <TextBlock Text="# 可实现智能识别圆、三角形、矩形，并自动转换为规范图形。" Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="启用墨迹识别" VerticalAlignment="Center" FontSize="14" Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchEnableInkToShape" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchEnableInkToShape_Toggled" IsOn="True" />
                                </ikw:SimpleStackPanel>
                            </ikw:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxAppearanceNewUI">
                            <GroupBox.Header>
                                <TextBlock Text="外观选项" FontWeight="Bold" Foreground="#18181b" FontSize="26" />
                            </GroupBox.Header>
                            <ikw:SimpleStackPanel Spacing="5">
                                <TextBlock Text="颜色主题" FontSize="14" />
                                <ComboBox Name="ComboBoxTheme" SelectedIndex="0"
                                          SelectionChanged="ComboBoxTheme_SelectionChanged">
                                    <ComboBoxItem Content="浅色（默认）" />
                                    <ComboBoxItem Content="深色" />
                                    <ComboBoxItem Content="跟随系统" />
                                </ComboBox>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="在调色盘窗口中显示 笔尖模式 按钮" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchEnableDisPlayNibModeToggle" IsOn="False"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchEnableDisPlayNibModeToggle_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="浮动工具栏背景色" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchColorfulViewboxFloatingBar" IsOn="False"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchIsColorfulViewboxFloatingBar_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="浮动工具栏 UI 90% 缩放" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchEnableViewboxFloatingBarScaleTransform"
                                                     IsOn="True" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchEnableViewboxFloatingBarScaleTransform_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="画板 UI 80% 缩放" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchEnableViewboxBlackBoardScaleTransform"
                                                     IsOn="False" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchEnableViewboxBlackBoardScaleTransform_Toggled" />
                                </ikw:SimpleStackPanel>
                            </ikw:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox>
                            <GroupBox.Header>
                                <TextBlock Text="PPT 选项" FontWeight="Bold" Foreground="#18181b" FontSize="26" />
                            </GroupBox.Header>
                            <ikw:SimpleStackPanel Spacing="5">
                                <TextBlock Text="# 此部分的设置项将会在幻灯片播放时使用，优先级高于其他设置项" Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="显示 PPT 下方翻页箭头按钮" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchShowPPTNavigationPanelBottom" IsOn="False"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchShowPPTNavigationPanelBottom_OnToggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="显示 PPT 下方页码按钮" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchShowButtonPPTNavigationBottom" IsOn="True"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchShowButtonPPTNavigationBottom_OnToggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="显示 PPT 侧边翻页箭头按钮" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchShowPPTNavigationPanelSide" IsOn="True"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchShowPPTNavigationPanelSide_OnToggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="显示 PPT 侧边页码按钮" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchShowButtonPPTNavigationSides" IsOn="True"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchShowButtonPPTNavigationSides_OnToggled" />
                                </ikw:SimpleStackPanel>
                                <Line HorizontalAlignment="Center" X1="0" Y1="0" X2="400" Y2="0" Stroke="#3f3f46"
                                      StrokeThickness="1" Margin="0,4,0,4" />
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="Microsoft PowerPoint 支持" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchSupportPowerPoint" IsOn="True" FontWeight="Bold"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchSupportPowerPoint_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="WPS 支持" VerticalAlignment="Center" FontSize="14" Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchSupportWPS" IsOn="True" FontWeight="Bold"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchSupportWPS_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock
                                    Text="# 不推荐使用 WPS Office，鉴于其对于触摸设备的较差支持及其自身的兼容性问题，对 WPS Office 支持时会导致 WPS Office 关闭时卡顿。"
                                    TextWrapping="Wrap" Foreground="#666666" />
                                <Line HorizontalAlignment="Center" X1="0" Y1="0" X2="400" Y2="0" Stroke="#3f3f46"
                                      StrokeThickness="1" Margin="0,4,0,4" />
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="进入 PPT 放映时自动进入批注模式" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchShowCanvasAtNewSlideShow" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchShowCanvasAtNewSlideShow_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="允许幻灯片模式下的双指手势" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerGestureInPresentationMode"
                                                     IsOn="False" FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchEnableTwoFingerGestureInPresentationMode_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="允许使用手指手势进行幻灯片翻页" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchEnableFingerGestureSlideShowControl"
                                                     IsOn="False" FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchEnableFingerGestureSlideShowControl_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock
                                    Text="# 允许开启画板时使用手指手势进行幻灯片翻页（启用后，在幻灯片放映模式下，当画板无墨迹时，使用手指（笔尖或手掌无法识别）左右滑动即可控制幻灯片翻页。）"
                                    TextWrapping="Wrap" Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="自动幻灯片截屏" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoSaveScreenShotInPowerPoint" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoSaveScreenShotInPowerPoint_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="#开启 自动幻灯片截屏 后将会在幻灯片有墨迹时翻页自动截屏" TextWrapping="Wrap"
                                           Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="自动保存幻灯片墨迹" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesInPowerPoint" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoSaveStrokesInPowerPoint_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="#开启 自动保存幻灯片墨迹 后将在结束幻灯片放映时自动将保存已有墨迹，并在下次打开时自动加载（文件名和幻灯片页数都要相同）"
                                           TextWrapping="Wrap" Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="记忆并提示上次播放位置" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchNotifyPreviousPage" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchNotifyPreviousPage_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="提示隐藏幻灯片" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchNotifyHiddenPage" IsOn="False" FontWeight="Bold"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchNotifyHiddenPage_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock Text="提示是否已启用自动播放" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchNotifyAutoPlayPresentation" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchNotifyAutoPlayPresentation_Toggled" />
                                </ikw:SimpleStackPanel>
                            </ikw:SimpleStackPanel>

                        </GroupBox>
                        <GroupBox>
                            <GroupBox.Header>
                                <TextBlock Text="高级选项" FontWeight="Bold" Foreground="#18181b" FontSize="26" />
                            </GroupBox.Header>
                            <ikw:SimpleStackPanel Spacing="5">
                                <TextBlock Text="#可在手指触摸画板时显示圆形橡皮或手掌触摸画板时显示的橡皮比&#x000A;手掌大很多时调整" Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="特殊屏幕模式" VerticalAlignment="Center" FontSize="14" Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchIsSpecialScreen" IsOn="True" FontWeight="Bold"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchIsSpecialScreen_OnToggled" />
                                </ikw:SimpleStackPanel>
                                <StackPanel Orientation="Horizontal"
                                            Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <Slider x:Name="TouchMultiplierSlider"
                                            Minimum="0" Maximum="2"
                                            Width="340"
                                            ui:ControlHelper.Header="触摸大小倍数"
                                            IsSnapToTickEnabled="True"
                                            TickFrequency="0.01" TickPlacement="None"
                                            ValueChanged="TouchMultiplierSlider_ValueChanged"
                                            Visibility="Visible" />
                                    <TextBlock Text="{Binding Value, ElementName=TouchMultiplierSlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14" Width="30" HorizontalAlignment="Center"
                                               Visibility="{Binding Path=Visibility, ElementName=TouchMultiplierSlider, Mode=OneWay}" />
                                </StackPanel>
                                <ikw:SimpleStackPanel Spacing="8" Margin="0,4,0,4"
                                                     Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <TextBlock FontSize="14" Text="在下方区域内用笔尖点击以估计触摸大小倍数" />
                                    <TextBlock Text="# 数值仅供参考" Foreground="#666666" />
                                    <Border Margin="0,0,20,0" CornerRadius="4" Height="48" Background="White"
                                            BorderBrush="Black" BorderThickness="2"
                                            TouchDown="BorderCalculateMultiplier_TouchDown" />
                                    <TextBlock Name="TextBlockShowCalculatedMultiplier" FontSize="14" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="橡皮擦绑定触摸大小倍数" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchEraserBindTouchMultiplier" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchEraserBindTouchMultiplier_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="# BoundsWidth 参数作为接触面积区分界限，用来区分橡皮和书写模式。笔尖模式参数值应较小。"
                                           TextWrapping="Wrap" Foreground="#666666" />
                                <StackPanel Orientation="Horizontal"
                                            Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <Slider x:Name="NibModeBoundsWidthSlider" Minimum="1" Maximum="50" Width="340"
                                            ui:ControlHelper.Header="笔尖模式 BoundsWidth"
                                            FontSize="15" IsSnapToTickEnabled="True" TickFrequency="1" Value="5"
                                            TickPlacement="None" ValueChanged="NibModeBoundsWidthSlider_ValueChanged" />
                                    <TextBlock
                                        Text="{Binding Value, ElementName=NibModeBoundsWidthSlider, Mode=OneWay}"
                                        VerticalAlignment="Bottom" Margin="10,0,0,8" FontSize="14" Width="30" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal"
                                            Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <Slider x:Name="FingerModeBoundsWidthSlider" Minimum="1" Maximum="50" Width="340"
                                            ui:ControlHelper.Header="手指模式 BoundsWidth"
                                            FontSize="15" IsSnapToTickEnabled="True" TickFrequency="1" Value="20"
                                            TickPlacement="None"
                                            ValueChanged="FingerModeBoundsWidthSlider_ValueChanged" />
                                    <TextBlock
                                        Text="{Binding Value, ElementName=FingerModeBoundsWidthSlider, Mode=OneWay}"
                                        VerticalAlignment="Bottom" Margin="10,0,0,8" FontSize="14" Width="30" />
                                </StackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="四边红外模式" VerticalAlignment="Center" FontSize="14" Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchIsQuadIR" IsOn="False" FontWeight="Bold"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchIsQuadIR_Toggled" />
                                </ikw:SimpleStackPanel>
                                <Line HorizontalAlignment="Center" X1="0" Y1="0" X2="400" Y2="0" Stroke="#3f3f46"
                                      StrokeThickness="1" Margin="0,4,0,4" />
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="记录日志" VerticalAlignment="Center" FontSize="14" Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchIsLogEnabled" IsOn="True" FontWeight="Bold"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchIsLogEnabled_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="# 日志文件超过 512 KB 时会自动删除。" TextWrapping="Wrap" Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="关闭软件时二次弹窗确认" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchIsSecondConfimeWhenShutdownApp" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchIsSecondConfimeWhenShutdownApp_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="启用EdgeGestureUtil"
                                               VerticalAlignment="Center"
                                               FontSize="14" Margin="0,0,6,0" />
                                    <Border Height="20" CornerRadius="3" Background="#fecaca" Margin="0,0,12,0"
                                            Padding="4,0">
                                        <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="3"
                                                             VerticalAlignment="Center">
                                            <Image Width="15" Height="15" VerticalAlignment="Center">
                                                <Image.Source>
                                                    <DrawingImage>
                                                        <DrawingImage.Drawing>
                                                            <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                                                                <GeometryDrawing Brush="#991b1b"
                                                                    Geometry="F1 M24,24z M0,0z M20.1758,20.0951L15.1058,9.97512C15.0358,9.83512,14.9958,9.68512,14.9958,9.52512L14.9958,2.99512 15.4958,2.99512C16.0458,2.99512 16.4958,2.54512 16.4958,1.99512 16.4958,1.44512 16.0458,0.995117 15.4958,0.995117L8.49582,0.995117C7.94582,0.995117 7.49582,1.44512 7.49582,1.99512 7.49582,2.54512 7.94582,2.99512 8.49582,2.99512L8.99582,2.99512 8.99582,9.52512C8.99582,9.67512,8.95582,9.83512,8.89582,9.97512L3.82582,20.0951C3.67582,20.4051 3.59582,20.7451 3.61582,21.0851 3.62582,21.4251 3.73582,21.7651 3.91582,22.0551 4.09582,22.3451 4.34582,22.5851 4.64582,22.7551 4.94582,22.9151 5.27582,23.0051 5.60582,23.0051L18.3758,23.0051C18.7558,23.0051 19.0558,22.9251 19.3558,22.7551 19.6558,22.5851 19.9058,22.3451 20.0858,22.0551 20.2658,21.7651 20.3658,21.4351 20.3858,21.0851 20.3958,20.7451 20.3258,20.4051 20.1758,20.1051L20.1758,20.0951z M10.6858,10.8651C10.8958,10.4451,11.0058,9.98512,11.0058,9.52512L11.0058,2.99512 13.0058,2.99512 13.0058,9.52512C13.0058,9.98512,13.1158,10.4551,13.3258,10.8651L15.3858,14.9951 8.62582,14.9951 10.6958,10.8651 10.6858,10.8651z" />
                                                            </DrawingGroup>
                                                        </DrawingImage.Drawing>
                                                    </DrawingImage>
                                                </Image.Source>
                                            </Image>
                                            <TextBlock Foreground="#991b1b" Text="实验性选项" FontSize="12"
                                                       VerticalAlignment="Center">
                                            </TextBlock>
                                        </ikw:SimpleStackPanel>
                                    </Border>
                                    <ui:ToggleSwitch OnContent="" OffContent=""
                                                     Toggled="ToggleSwitchIsEnableEdgeGestureUtil_Toggled"
                                                     Name="ToggleSwitchIsEnableEdgeGestureUtil" IsOn="True"
                                                     FontFamily="Microsoft YaHei UI" FontWeight="Bold" />
                                </ikw:SimpleStackPanel>
                                <TextBlock TextWrapping="Wrap" Foreground="#666666">
                                    <Run
                                        Text="# EdgeGestureUtil可以暂时阻止在使用触摸时触发边缘手势（如Windows10环境下，屏幕左边缘滑动进入任务视图，右边缘滑动弹出通知中心；Windows11环境下，底部向上滑动打开开始菜单），其原理是使用了" />
                                    <Run FontFamily="Consolas" Text="System.EdgeGesture.DisableTouchWhenFullscreen" />
                                    <Run
                                        Text="（当应用程序窗口处于活动状态且处于全屏模式 (或拥有的窗口) 处于活动状态时，防止边缘手势行为。）来实现的。如果有异常，请关闭该选项，该选项应该能够实时生效。（Win7和Win8用户该选项无法使用）" />
                                </TextBlock>
                            </ikw:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox>
                            <GroupBox.Header>
                                <TextBlock Text="自动选项" FontWeight="Bold" Foreground="#18181b" FontSize="26" />
                            </GroupBox.Header>
                            <ikw:SimpleStackPanel Spacing="0">
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入“希沃白板”时自动收纳" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInEasiNote" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInEasiNote_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="自动收纳忽略桌面EN批注窗口" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInEasiNoteIgnoreDesktopAnno" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInEasiNoteIgnoreDesktopAnno_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入“希沃视频展台”时自动收纳" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInEasiCamera" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInEasiCamera_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入“希沃轻白板”时自动收纳" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInEasiNote3C" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInEasiNote3C_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入“希沃品课”时自动收纳" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInSeewoPincoTeacher" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInSeewoPincoTeacher_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入“鸿合白板”时自动收纳" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInHiteTouchPro" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInHiteTouchPro_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入“鸿合视频展台”时自动收纳" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInHiteCamera" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInHiteCamera_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入“文香白板”时自动收纳" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInWxBoardMain" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInWxBoardMain_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入“中原旧白板”时自动收纳" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInOldZyBoard" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInOldZyBoard_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入“微软 Whiteboard”时自动收纳" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInMSWhiteboard" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInMSWhiteboard_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="进入PPT 放映时自动收纳至侧边栏" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInPPTSlideShow" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoFoldInPPTSlideShow_Toggled" />
                                </ikw:SimpleStackPanel>
                                <Line HorizontalAlignment="Center" X1="0" Y1="0" X2="400" Y2="0" Stroke="#3f3f46"
                                      StrokeThickness="1" Margin="0,4,0,4" />
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="自动查杀希沃“PPT 小工具”" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoKillPptService" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoKillPptService_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock
                                    Text="# 请注意，查杀 PPT 小工具会导致希沃课堂授课助手无法使用，直接进入希沃课堂授课助手安装目录删除 Office.dll 文件即可进入 PPT 放映时不会启动希沃的 PPT 工具栏。"
                                    TextWrapping="Wrap" Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="自动查杀 希沃白板5" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoKillEasiNote" IsOn="False" FontWeight="Bold"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoKillEasiNote_Toggled" />
                                </ikw:SimpleStackPanel>
                                <Line HorizontalAlignment="Center" X1="0" Y1="0" X2="400" Y2="0" Stroke="#3f3f46"
                                      StrokeThickness="1" Margin="0,4,0,4" />
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="清屏时自动截图" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesAtClear" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoSaveStrokesAtClear_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="截图分日期文件夹保存" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchSaveScreenshotsInDateFolders" IsOn="False"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchSaveScreenshotsInDateFolders_Toggled" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="截图时自动保存墨迹" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesAtScreenshot" IsOn="True"
                                                     FontWeight="Bold" OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoSaveStrokesAtScreenshot_Toggled" />
                                </ikw:SimpleStackPanel>
                                <Line HorizontalAlignment="Center" X1="0" Y1="0" X2="400" Y2="0" Stroke="#3f3f46"
                                      StrokeThickness="1" Margin="0,4,0,4" />
                                <!--
                                <ui:ToggleSwitch Name="ToggleSwitchClearExitingWritingMode" Header="切换到鼠标模式后自动清屏" IsOn="False" OnContent="开" OffContent="关" Toggled="ToggleSwitchExitingWritingMode_Toggled"/>
                                -->
                                <StackPanel Orientation="Horizontal">
                                    <Slider x:Name="SideControlMinimumAutomationSlider"
                                            HorizontalAlignment="Left"
                                            Minimum="0" Maximum="10"
                                            Width="335"
                                            ui:ControlHelper.Header="自动截图最小墨迹量(数值为 0 即有墨迹时会自动截图)"
                                            IsSnapToTickEnabled="True" Value="0"
                                            TickFrequency="1" TickPlacement="None"
                                            ValueChanged="SideControlMinimumAutomationSlider_ValueChanged" />
                                    <TextBlock
                                        Text="{Binding Value, ElementName=SideControlMinimumAutomationSlider, Mode=OneWay}"
                                        VerticalAlignment="Bottom" Margin="10,0,0,8"
                                        FontSize="14" Width="25" HorizontalAlignment="Center" />
                                </StackPanel>
                                <TextBlock FontSize="15">墨迹、截图自动保存位置:</TextBlock>
                                <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBox Width="320" x:Name="AutoSavedStrokesLocation" Text="D:\Ink Canvas"
                                             TextWrapping="Wrap"
                                             TextChanged="AutoSavedStrokesLocationTextBox_TextChanged" />
                                    <Button Name="AutoSavedStrokesLocationButton" Grid.Row="1" Content="浏览"
                                            Click="AutoSavedStrokesLocationButton_Click" />
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="12">
                                    <Button Name="SetAutoSavedStrokesLocationToDiskDButton" Grid.Row="1"
                                            Content="设置保存到 D:\Ink Canvas"
                                            Click="SetAutoSavedStrokesLocationToDiskDButton_Click" />
                                    <Button Name="SetAutoSavedStrokesLocationToDocumentFolderButton" Grid.Row="1"
                                            Content="设置保存到 文档"
                                            Click="SetAutoSavedStrokesLocationToDocumentFolderButton_Click" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="* 请注意检查保存文件夹是否有写入权限" TextWrapping="Wrap" Foreground="#666666" />
                                <ikw:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="定期自动删除超过保存时间的墨迹、截图文件" VerticalAlignment="Center" FontSize="14"
                                               Margin="0,0,14,0" />
                                    <ui:ToggleSwitch Name="ToggleSwitchAutoDelSavedFiles" IsOn="True" FontWeight="Bold"
                                                     OnContent="开" OffContent="关"
                                                     Toggled="ToggleSwitchAutoDelSavedFiles_Toggled" />
                                </ikw:SimpleStackPanel>
                                <TextBlock Text="！请注意自动删除功能将会删除自动保存目录下所有后缀名为 .icstk 和 .png 的文件！" TextWrapping="Wrap"
                                           Foreground="Black" />
                                <TextBlock FontSize="15">保存时间设置（Days）:</TextBlock>
                                <ComboBox Name="ComboBoxAutoDelSavedFilesDaysThreshold" SelectedIndex="4"
                                          SelectionChanged="ComboBoxAutoDelSavedFilesDaysThreshold_SelectionChanged">
                                    <ComboBoxItem Content="1" />
                                    <ComboBoxItem Content="3" />
                                    <ComboBoxItem Content="5" />
                                    <ComboBoxItem Content="7" />
                                    <ComboBoxItem Content="15" />
                                    <ComboBoxItem Content="30" />
                                    <ComboBoxItem Content="60" />
                                    <ComboBoxItem Content="100" />
                                    <ComboBoxItem Content="365" />
                                </ComboBox>
                            </ikw:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox>
                            <GroupBox.Header>
                                <TextBlock Text="关于 Ink Canvas Artistry" FontWeight="Bold" Foreground="#18181b"
                                           FontSize="26" />
                            </GroupBox.Header>
                            <ikw:SimpleStackPanel Spacing="5">
                                <ikw:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock FontSize="18" FontWeight="Bold" Text="当前版本：" />
                                    <TextBlock x:Name="AppVersionTextBlock" FontSize="18" FontWeight="Bold"
                                               Text="4.X.X.X" />
                                </ikw:SimpleStackPanel>
                                <TextBlock
                                    Text="* 使用和分发本软件前，请您应当且务必知晓相关开源协议，且您应当知晓本软件基于 https://github.com/WXRIW/Ink-Canvas 修改而成。"
                                    TextWrapping="Wrap" Foreground="#666666" />
                                <Border BorderBrush="DarkBlue" BorderThickness="2" CornerRadius="5" Padding="0,5">
                                    <WrapPanel VerticalAlignment="Center" HorizontalAlignment="Center"
                                               Orientation="Horizontal">
                                        <TextBlock Text="开源协议: " FontSize="15" FontWeight="Bold" />
                                        <Image Source="/Resources/Icons-png/ic_fluent_scales_24_regular.png"
                                               RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20"
                                               Height="20" />
                                        <TextBlock Text="GNU General Public License v3.0" FontSize="15" />
                                    </WrapPanel>
                                </Border>
                                <TextBlock FontSize="15">
                                    <Bold>本项目仓库源:</Bold>
                                    <Hyperlink Click="HyperlinkSourceToPresentRepository_Click">
                                        <TextBlock Margin="2,0" Width="250"
                                                   Text="https://github.com/ChangSakura/Ink-Canvas" TextWrapping="Wrap" />
                                    </Hyperlink>
                                </TextBlock>
                                <WrapPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock Text="本项目开发者: " FontSize="15" FontWeight="Bold" />
                                    <Image Source="/Resources/DeveloperAvatars/ChangSakura.png"
                                           RenderOptions.BitmapScalingMode="HighQuality" Width="20" Height="20" />
                                    <TextBlock Text="CJ Wu (ChangSakura)" FontSize="15" />
                                </WrapPanel>

                                <Line HorizontalAlignment="Center" X1="0" Y1="0" X2="350" Y2="0" Stroke="Black"
                                      StrokeThickness="2" />

                                <TextBlock FontSize="15">
                                    <Bold>原项目仓库源:</Bold>
                                    <Hyperlink Click="HyperlinkSourceToOringinalRepository_Click">
                                        <TextBlock Margin="2,0" Text="https://github.com/WXRIW/Ink-Canvas"></TextBlock>
                                    </Hyperlink>
                                </TextBlock>
                                <WrapPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock Text="原项目开发者: " FontSize="15" FontWeight="Bold" />
                                    <Image Source="/Resources/DeveloperAvatars/WXRIW.png"
                                           RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20"
                                           Height="20">
                                        <Image.Clip>
                                            <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                        </Image.Clip>
                                    </Image>
                                    <TextBlock Text="XY Wang (WXRIW)" FontSize="15" />
                                </WrapPanel>
                                <WrapPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock Text="原项目贡献者: " FontSize="15" FontWeight="Bold" Margin="0,0,0,5" />
                                    <ikw:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/Kengwang.png"
                                               RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20"
                                               Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="Kengwang" FontSize="15" />
                                    </ikw:SimpleStackPanel>
                                    <ikw:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/Raspberry-Monster.jpg"
                                               RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20"
                                               Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="Raspberry Kan " FontSize="15" />
                                    </ikw:SimpleStackPanel>
                                    <ikw:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/jiajiaxd.jpg"
                                               RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20"
                                               Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="jiajiaxd" FontSize="15" />
                                    </ikw:SimpleStackPanel>
                                    <ikw:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/CN-Ironegg.jpg"
                                               RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20"
                                               Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="CN-Ironegg" FontSize="15" />
                                    </ikw:SimpleStackPanel>
                                    <ikw:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/clover-yan.png"
                                               RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20"
                                               Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="Clover Yan" FontSize="15" />
                                    </ikw:SimpleStackPanel>
                                    <ikw:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/STBBRD.png"
                                               RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20"
                                               Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="STBBRD" FontSize="15" />
                                    </ikw:SimpleStackPanel>
                                    <ikw:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/ChangSakura.png"
                                               RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20"
                                               Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="ChangSakura" FontSize="15" />
                                    </ikw:SimpleStackPanel>
                                </WrapPanel>
                            </ikw:SimpleStackPanel>
                        </GroupBox>
                    </StackPanel>
                </ui:ScrollViewerEx>
                <Grid Background="White" Margin="20" Height="40" VerticalAlignment="Top">
                    <ikw:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <ui:FontIcon Height="28" Width="28" FontSize="26"
                                     FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe713;"
                                     Foreground="Black" />
                        <TextBlock Margin="10,-2,0,0" Text="详细设置" FontWeight="Bold" FontSize="26" />
                    </ikw:SimpleStackPanel>
                </Grid>
                <Grid VerticalAlignment="Bottom" Height="50">
                    <Button
                        Width="120" Margin="10"
                        HorizontalAlignment="Right"
                        Content="关闭"
                        Click="BtnSettings_Click" />
                </Grid>
            </Grid>
        </Border>

        <!--// 通知弹窗 //-->
        <Grid Name="GridNotifications" Margin="0,110" Visibility="Collapsed" HorizontalAlignment="Center"
              VerticalAlignment="Bottom">
            <Border CornerRadius="10" MaxHeight="200" Padding="20 10" Background="White" Opacity="0.95"
                    BorderBrush="Black" BorderThickness="1.5">
                <TextBlock Name="TextBlockNotice" Text="测试文本" VerticalAlignment="Center" HorizontalAlignment="Center"
                           FontSize="16" />
            </Border>
        </Grid>

        <!--// Old UI //-->
        <Viewbox Name="ViewBoxStackPanelMain" Visibility="Visible" Margin="10,10,10,55" HorizontalAlignment="Right"
                 VerticalAlignment="Bottom" Width="46">
            <StackPanel Name="StackPanelMain" Width="46">
                <StackPanel Name="StackPanelControl">
                    <Button Name="BtnExit" Content="退出"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnExit_Click" Background="#7F909090" />

                    <Button Name="BtnThickness" Content="粗细" Visibility="Collapsed"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnThickness_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                            Background="{Binding ElementName=BtnExit, Path=Background}" />

                    <Button Name="BtnSwitchTheme" Content="深色"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                            Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <!-- Click="BtnSwitchTheme_Click" -->

                    <Button Name="BtnSwitch" Content="背景"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnSwitch_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                            Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <Button x:Name="BtnHideInkCanvas" Content="隐藏&#x000A;画板"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnHideInkCanvas_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                            Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <Button x:Name="BtnCheckPPT" Visibility="Collapsed" Content="检查"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnCheckPPT_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                            Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <StackPanel Name="StackPanelPPTButtons">
                        <Button x:Name="BtnPPTSlideShow" Visibility="Collapsed" Content="从头&#x000A;放映"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShow_Click"
                                Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                                Background="{Binding ElementName=BtnExit, Path=Background}" />
                        <Button x:Name="BtnPPTSlideShowEnd" Visibility="Collapsed" Content="结束&#x000A;放映"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShowEnd_Click"
                                Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                                Background="{Binding ElementName=BtnExit, Path=Background}" />
                        <StackPanel Name="StackPanelPPTControls" Visibility="Collapsed">
                            <Button x:Name="BtnPPTSlidesUp" Content="↑"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesUp_Click"
                                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                                    Background="{Binding ElementName=BtnExit, Path=Background}" />
                            <Button x:Name="BtnPPTSlidesDown" Content="↓"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesDown_Click"
                                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                                    Background="{Binding ElementName=BtnExit, Path=Background}" />
                        </StackPanel>
                    </StackPanel>
                    <Button x:Name="BtnSwitchSide" Content="⇆"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnSwitchSide_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                            Background="{Binding ElementName=BtnExit, Path=Background}" />
                </StackPanel>
                <Button x:Name="BtnHideControl" Content="⇅"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnHideControl_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}" />
            </StackPanel>
        </Viewbox>
        <Viewbox Name="ViewBoxStackPanelShapes" Margin="{Binding ElementName=ViewBoxStackPanelMain, Path=Margin}"
                 Width="46" HorizontalAlignment="Left" VerticalAlignment="Bottom" Visibility="Visible">
            <StackPanel Name="StackPanelShapes" Width="46">
                <Button Name="BtnFingerDragMode" Content="单指&#x000A;拖动" Visibility="Visible"
                        Margin="0,25,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnFingerDragMode_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}" />
                <StackPanel IsVisibleChanged="StackPanel_IsVisibleChanged"
                            Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}">
                    <StackPanel Visibility="{Binding ElementName=StackPanelPPTControls, Path=Visibility}">
                        <Button Content="↑"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlidesUp_Click"
                                Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                                Background="{Binding ElementName=BtnExit, Path=Background}" />
                        <Button Content="↓"
                                Margin="0,10,0,15" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlidesDown_Click"
                                Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                                Background="{Binding ElementName=BtnExit, Path=Background}" />
                    </StackPanel>
                </StackPanel>
                <Button x:Name="BtnUndo"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnUndo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" Visibility="Collapsed" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Undo" />
                        <TextBlock Text="撤销" Margin="0,4,0,0" />
                    </StackPanel>
                </Button>
                <Button x:Name="BtnRedo"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnRedo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" Visibility="Collapsed" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Redo" />
                        <TextBlock Text="恢复" Margin="0,4,0,0" />
                    </StackPanel>
                </Button>
                <Button Name="BtnClearAndHideCanvas" Content="清屏&#x000A;&amp;&#x000A;隐藏" Visibility="Collapsed"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Block.TextAlignment="Center"
                        Click="BtnSelect_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}" />
                <Grid Name="GridForLeftSideReservedSpace"
                      Height="{Binding ElementName=StackPanelInfo, Path=ActualHeight}" />
            </StackPanel>
        </Viewbox>

        <!--// PPT 翻页按钮 //-->
        <Viewbox x:Name="PPTNavigationBottomLeft" Visibility="Visible" Margin="2,0,0,2" Height="40"
                 HorizontalAlignment="Left" VerticalAlignment="Bottom">
            <Border BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}"
                    Background="{DynamicResource FloatBarBackground}" Opacity="0.4" CornerRadius="6">
                <ikw:SimpleStackPanel Orientation="Horizontal">
                    <Border Width="40" Height="40" MouseUp="GridPPTControlPrevious_MouseUp"
                            MouseDown="Border_MouseDown" CornerRadius="5 5 0 0" Background="Transparent">
                        <ui:FontIcon Height="26" Width="26" FontFamily="{StaticResource FluentIconFontFamily}"
                                     Glyph="&#xedd5;" Foreground="{DynamicResource FloatBarForeground}" />
                    </Border>
                    <Border x:Name="PptNavigationBottomBtn" Visibility="Visible" MouseUp="PPTNavigationBtn_Click"
                            MouseDown="Border_MouseDown" Width="40" Height="38" Background="Transparent">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1" />
                                <ColumnDefinition Width="36" />
                                <ColumnDefinition Width="1" />
                            </Grid.ColumnDefinitions>
                            <Line Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0"
                                  X2="0" Y2="25" Stroke="{DynamicResource FloatBarForeground}" StrokeThickness="1" />
                            <TextBlock x:Name="PptNavigationTextBlockBottom" Text="0/0" Grid.Column="1"
                                       HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="9"
                                       Foreground="{DynamicResource FloatBarForeground}" />
                            <Line Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0"
                                  X2="0" Y2="25" Stroke="{DynamicResource FloatBarForeground}" StrokeThickness="1" />
                        </Grid>
                    </Border>
                    <Border Width="40" Height="40" MouseUp="GridPPTControlNext_MouseUp" MouseDown="Border_MouseDown"
                            CornerRadius="0 0 5 5" Background="Transparent">
                        <ui:FontIcon Height="26" Width="26" FontFamily="{StaticResource FluentIconFontFamily}"
                                     Glyph="&#xedd6;" Foreground="{DynamicResource FloatBarForeground}" />
                    </Border>
                </ikw:SimpleStackPanel>
            </Border>
        </Viewbox>
        <Viewbox x:Name="PPTNavigationBottomRight" Visibility="Visible" Margin="2,0,0,2" Height="40"
                 HorizontalAlignment="Right" VerticalAlignment="Bottom">
            <Border BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}"
                    Background="{DynamicResource FloatBarBackground}" Opacity="0.4" CornerRadius="6">
                <ikw:SimpleStackPanel Orientation="Horizontal">
                    <Border Width="40" Height="40" MouseUp="GridPPTControlPrevious_MouseUp"
                            MouseDown="Border_MouseDown" CornerRadius="5 5 0 0" Background="Transparent">
                        <ui:FontIcon Height="26" Width="26" FontFamily="{StaticResource FluentIconFontFamily}"
                                     Glyph="&#xedd5;" Foreground="{DynamicResource FloatBarForeground}" />
                    </Border>
                    <Border Visibility="{Binding ElementName=PptNavigationBottomBtn, Path=Visibility}"
                            MouseUp="PPTNavigationBtn_Click" MouseDown="Border_MouseDown" Width="40" Height="38"
                            Background="Transparent">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1" />
                                <ColumnDefinition Width="36" />
                                <ColumnDefinition Width="1" />
                            </Grid.ColumnDefinitions>
                            <Line Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0"
                                  X2="0" Y2="25" Stroke="{DynamicResource FloatBarForeground}" StrokeThickness="1" />
                            <TextBlock Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center"
                                       FontSize="9" Foreground="{DynamicResource FloatBarForeground}"
                                       Text="{Binding ElementName=PptNavigationTextBlockBottom, Path=Text}" />
                            <Line Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0"
                                  X2="0" Y2="25" Stroke="{DynamicResource FloatBarForeground}" StrokeThickness="1" />
                        </Grid>
                    </Border>
                    <Border Width="40" Height="40" MouseUp="GridPPTControlNext_MouseUp" MouseDown="Border_MouseDown"
                            CornerRadius="0 0 5 5" Background="Transparent">
                        <ui:FontIcon Height="26" Width="26" FontFamily="{StaticResource FluentIconFontFamily}"
                                     Glyph="&#xedd6;" Foreground="{DynamicResource FloatBarForeground}" />
                    </Border>
                </ikw:SimpleStackPanel>
            </Border>
        </Viewbox>
        <Viewbox x:Name="PPTNavigationSidesLeft" Visibility="Visible" Margin="6,0,0,0" Width="40"
                 HorizontalAlignment="Left" VerticalAlignment="Center">
            <Border BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}"
                    Background="{DynamicResource FloatBarBackground}" Opacity="0.4" CornerRadius="6">
                <ikw:SimpleStackPanel Orientation="Vertical">
                    <Border Width="40" Height="40" MouseUp="GridPPTControlPrevious_MouseUp"
                            MouseDown="Border_MouseDown" CornerRadius="5 5 0 0" Background="Transparent">
                        <ui:FontIcon Height="26" Width="26" FontFamily="{StaticResource FluentIconFontFamily}"
                                     Glyph="&#xedd7;" Foreground="{DynamicResource FloatBarForeground}" />
                    </Border>
                    <Border x:Name="PptNavigationSidesBtn" Visibility="Visible" MouseUp="PPTNavigationBtn_Click"
                            MouseDown="Border_MouseDown" Width="40" Height="38" Background="Transparent">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="1" />
                                <RowDefinition Height="36" />
                                <RowDefinition Height="1" />
                            </Grid.RowDefinitions>
                            <Line Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0"
                                  X2="25" Y2="0" Stroke="{DynamicResource FloatBarForeground}" StrokeThickness="1" />
                            <TextBlock Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center"
                                       FontSize="9" Foreground="{DynamicResource FloatBarForeground}"
                                       Text="{Binding ElementName=PptNavigationTextBlockBottom, Path=Text}" />
                            <Line Grid.Row="2" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0"
                                  X2="25" Y2="0" Stroke="{DynamicResource FloatBarForeground}" StrokeThickness="1" />
                        </Grid>
                    </Border>
                    <Border Width="40" Height="40" MouseUp="GridPPTControlNext_MouseUp" MouseDown="Border_MouseDown"
                            CornerRadius="0 0 5 5" Background="Transparent">
                        <ui:FontIcon Height="26" Width="26" FontFamily="{StaticResource FluentIconFontFamily}"
                                     Glyph="&#xedd8;" Foreground="{DynamicResource FloatBarForeground}" />
                    </Border>
                </ikw:SimpleStackPanel>
            </Border>
        </Viewbox>
        <Viewbox x:Name="PPTNavigationSidesRight" Visibility="Visible" Margin="0,0,6,0" Width="40"
                 HorizontalAlignment="Right" VerticalAlignment="Center">
            <Border BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}"
                    Background="{DynamicResource FloatBarBackground}" Opacity="0.4" CornerRadius="6">
                <ikw:SimpleStackPanel Orientation="Vertical">
                    <Border Width="40" Height="40" MouseUp="GridPPTControlPrevious_MouseUp"
                            MouseDown="Border_MouseDown" CornerRadius="5 5 0 0" Background="Transparent">
                        <ui:FontIcon Height="26" Width="26" FontFamily="{StaticResource FluentIconFontFamily}"
                                     Glyph="&#xedd7;" Foreground="{DynamicResource FloatBarForeground}" />
                    </Border>
                    <Border Visibility="{Binding ElementName=PptNavigationSidesBtn, Path=Visibility}"
                            MouseUp="PPTNavigationBtn_Click" MouseDown="Border_MouseDown" Width="40" Height="38"
                            Background="Transparent">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="1" />
                                <RowDefinition Height="36" />
                                <RowDefinition Height="1" />
                            </Grid.RowDefinitions>
                            <Line Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0"
                                  X2="25" Y2="0" Stroke="{DynamicResource FloatBarForeground}" StrokeThickness="1" />
                            <TextBlock Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center"
                                       FontSize="9" Foreground="{DynamicResource FloatBarForeground}"
                                       Text="{Binding ElementName=PptNavigationTextBlockBottom, Path=Text}" />
                            <Line Grid.Row="2" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0"
                                  X2="25" Y2="0" Stroke="{DynamicResource FloatBarForeground}" StrokeThickness="1" />
                        </Grid>
                    </Border>
                    <Border Width="40" Height="40" MouseUp="GridPPTControlNext_MouseUp" MouseDown="Border_MouseDown"
                            CornerRadius="0 0 5 5" Background="Transparent">
                        <ui:FontIcon Height="26" Width="26" FontFamily="{StaticResource FluentIconFontFamily}"
                                     Glyph="&#xedd8;" Foreground="{DynamicResource FloatBarForeground}" />
                    </Border>
                </ikw:SimpleStackPanel>
            </Border>
        </Viewbox>

        <!--// 浮动批注主窗口 //-->
        <Viewbox Name="ViewboxFloatingBar" Margin="100,10,-2000,-200"
                 HorizontalAlignment="Left" Height="50" VerticalAlignment="Top">
            <Viewbox.LayoutTransform>
                <ScaleTransform x:Name="ViewboxFloatingBarScaleTransform" ScaleX="1" ScaleY="1" />
            </Viewbox.LayoutTransform>
            <ikw:SimpleStackPanel Orientation="Horizontal">
                <Border x:Name="BorderFloatingBarMoveControls" Width="36" Height="36" CornerRadius="5"
                        Background="{DynamicResource FloatBarBackground}" BorderThickness="1"
                        BorderBrush="{DynamicResource FloatBarBorderBrush}"
                        MouseDown="SymbolIconEmoji_MouseDown" MouseUp="SymbolIconEmoji_MouseUp">
                    <ikw:SimpleStackPanel Margin="0,5,0,5" Orientation="Horizontal" HorizontalAlignment="Center">
                        <ui:FontIcon Name="SymbolIconEmoji1" Height="22" Width="28"
                                     FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe76e;"
                                     Foreground="{DynamicResource FloatBarForeground}" />
                        <ui:FontIcon Name="SymbolIconEmoji2" Height="22" Width="0"
                                     FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe899;"
                                     Foreground="{DynamicResource FloatBarForeground}" />
                    </ikw:SimpleStackPanel>
                </Border>
                <Border Padding="2 1" Margin="2,0,0,0" Visibility="Visible" Height="36"
                        Name="BorderFloatingBarMainControls" Background="{DynamicResource FloatBarBackground}"
                        CornerRadius="5" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                    <ikw:SimpleStackPanel Margin="2,0" Name="StackPanelFloatingBar" Orientation="Horizontal">
                        <ikw:SimpleStackPanel Name="Cursor_Icon" MouseDown="Border_MouseDown" MouseUp="CursorIcon_Click"
                                             Background="Transparent" Orientation="Vertical"
                                             HorizontalAlignment="Center" Width="28">
                            <ui:FontIcon Height="22" Width="30" FontSize="16"
                                         FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe8b0;"
                                         Foreground="{DynamicResource FloatBarForeground}" />
                            <TextBlock Text="鼠标" Margin="1,-1,0,0" x:Name="FloatBarSelectIconTextBlock"
                                       Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                       TextAlignment="Center" />
                        </ikw:SimpleStackPanel>
                        <ikw:SimpleStackPanel Name="Pen_Icon" MouseDown="Border_MouseDown" MouseUp="PenIcon_Click"
                                             Background="Transparent" Orientation="Vertical"
                                             HorizontalAlignment="Center" Width="30">
                            <ui:FontIcon x:Name="PenIcon" Height="22" Width="30" FontSize="16"
                                         FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xee56;"
                                         Foreground="{DynamicResource FloatBarForeground}" />
                            <TextBlock Text="批注" Margin="1,-1,0,0"
                                       Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                       Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                       TextAlignment="Center" />
                        </ikw:SimpleStackPanel>
                        <ikw:SimpleStackPanel Name="SymbolIconDelete" MouseDown="Border_MouseDown"
                                             MouseUp="SymbolIconDelete_MouseUp" Background="Transparent"
                                             Orientation="Vertical" HorizontalAlignment="Center" Width="30">
                            <ui:FontIcon Height="22" Width="30" FontSize="16"
                                         FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe74d;"
                                         Foreground="{DynamicResource FloatBarForeground}" />
                            <TextBlock Text="清空" Margin="1,-1,0,0"
                                       Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                       Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                       TextAlignment="Center" />
                        </ikw:SimpleStackPanel>
                        <ikw:SimpleStackPanel Name="StackPanelCanvasControls" Visibility="Visible"
                                             Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <Grid Width="0">
                                <Border x:Name="PenPalette" Margin="-131,-190,-239,35" Visibility="Visible"
                                        Background="{DynamicResource FloatBarBackground}"
                                        BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                        CornerRadius="5">
                                    <ikw:SimpleStackPanel>
                                        <Border Background="{DynamicResource FloatBarTitleBackground}"
                                                BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                                CornerRadius="5,5,0,0" Margin="-1 -1 -1 0" Padding="15,5">
                                            <TextBlock Text="墨迹选项" Foreground="{DynamicResource FloatBarForeground}"
                                                       FontWeight="Bold" />
                                        </Border>
                                        <ikw:SimpleStackPanel Orientation="Horizontal">
                                            <Viewbox Width="245">
                                                <ikw:SimpleStackPanel Margin="20 10">
                                                    <Viewbox Height="80" HorizontalAlignment="Center"
                                                             VerticalAlignment="Center">
                                                        <ikw:SimpleStackPanel>
                                                            <Controls:UniformGrid Columns="2" Width="310" Height="55">
                                                                <ikw:SimpleStackPanel Orientation="Horizontal"
                                                                    Height="35">
                                                                    <Label Content="笔锋" Margin="0,0,12,0"
                                                                           Foreground="{DynamicResource FloatBarForeground}"
                                                                           FontSize="15" VerticalAlignment="Center" />
                                                                    <ComboBox Height="30" VerticalAlignment="Center"
                                                                              x:Name="ComboBoxPenStyle"
                                                                              SelectedIndex="0"
                                                                              SelectionChanged="ComboBoxPenStyle_SelectionChanged">
                                                                        <ComboBoxItem Content="点集笔锋" />
                                                                        <ComboBoxItem Content="速率笔锋" />
                                                                        <ComboBoxItem Content="关闭笔锋" />
                                                                    </ComboBox>
                                                                </ikw:SimpleStackPanel>
                                                                <ikw:SimpleStackPanel Margin="0,-5,0,-5"
                                                                    VerticalAlignment="Center"
                                                                    HorizontalAlignment="Right">
                                                                    <ikw:SimpleStackPanel
                                                                        x:Name="NibModeSimpleStackPanel"
                                                                        Orientation="Horizontal" Width="135">
                                                                        <Label Content="笔尖模式" FontSize="15"
                                                                               VerticalAlignment="Center" />
                                                                        <ui:ToggleSwitch
                                                                            x:Name="ToggleSwitchEnableNibMode"
                                                                            MinWidth="0" Width="70" OnContent="开"
                                                                            OffContent="关" Margin="10,0,0,0"
                                                                            Toggled="ToggleSwitchEnableNibMode_Toggled"
                                                                            IsOn="True" />
                                                                    </ikw:SimpleStackPanel>
                                                                    <ikw:SimpleStackPanel Orientation="Horizontal"
                                                                        Width="135">
                                                                        <Label Margin="0,0,10,0" Content="墨迹识别"
                                                                               Foreground="{DynamicResource FloatBarForeground}"
                                                                               FontSize="15" VerticalAlignment="Center" />
                                                                        <ui:ToggleSwitch
                                                                            Foreground="{DynamicResource FloatBarForeground}"
                                                                            Width="70" OnContent="开" OffContent="关"
                                                                            Toggled="ToggleSwitchEnableInkToShape_Toggled"
                                                                            MinWidth="0"
                                                                            IsOn="{Binding ElementName=ToggleSwitchEnableInkToShape, Path=IsOn}" />
                                                                    </ikw:SimpleStackPanel>
                                                                </ikw:SimpleStackPanel>
                                                            </Controls:UniformGrid>
                                                            <StackPanel Orientation="Horizontal" Height="30">
                                                                <Label Margin="0,0,10,0" Content="粗细"
                                                                       Foreground="{DynamicResource FloatBarForeground}"
                                                                       FontSize="15" VerticalAlignment="Center" />
                                                                <Slider x:Name="InkWidthSlider" Minimum="1"
                                                                        Maximum="30" Width="250" FontSize="20"
                                                                        IsSnapToTickEnabled="True" Value="5"
                                                                        TickFrequency="1" TickPlacement="None"
                                                                        ValueChanged="InkWidthSlider_ValueChanged" />
                                                                <TextBlock
                                                                    Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                                                                    Foreground="{DynamicResource FloatBarForeground}"
                                                                    VerticalAlignment="Bottom" Margin="10,0,0,8"
                                                                    FontSize="14" />
                                                            </StackPanel>
                                                        </ikw:SimpleStackPanel>
                                                    </Viewbox>
                                                    <ikw:SimpleStackPanel Width="310">
                                                        <Border Width="310" Height="120" BorderBrush="Black"
                                                                BorderThickness="0" CornerRadius="5">
                                                            <Controls:UniformGrid Rows="2" Height="120">
                                                                <ikw:SimpleStackPanel Height="50"
                                                                    Orientation="Horizontal" Width="310">
                                                                    <Controls:UniformGrid Columns="5" Width="310">
                                                                        <Border Background="Transparent"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseDown="Border_MouseDown"
                                                                            MouseUp="ColorThemeSwitch_MouseUp">
                                                                            <Grid Margin="5">
                                                                                <ui:FontIcon
                                                                                    x:Name="ColorThemeSwitchIcon1"
                                                                                    VerticalAlignment="Top" Height="26"
                                                                                    Width="26"
                                                                                    FontFamily="{StaticResource FluentIconFontFamily}"
                                                                                    Glyph="&#xe706;"
                                                                                    Foreground="{DynamicResource FloatBarForeground}" />
                                                                                <ui:FontIcon
                                                                                    x:Name="ColorThemeSwitchIcon2"
                                                                                    VerticalAlignment="Top" Height="0"
                                                                                    Width="0"
                                                                                    FontFamily="{StaticResource FluentIconFontFamily}"
                                                                                    Glyph="&#xe708;"
                                                                                    Foreground="{DynamicResource FloatBarForeground}" />
                                                                                <TextBlock
                                                                                    x:Name="ColorThemeSwitchTextBlock"
                                                                                    Foreground="{DynamicResource FloatBarForeground}"
                                                                                    Text="亮系"
                                                                                    VerticalAlignment="Bottom"
                                                                                    HorizontalAlignment="Center"
                                                                                    FontSize="13" />
                                                                            </Grid>
                                                                        </Border>
                                                                        <Border x:Name="BorderPenColorBlack"
                                                                            Background="Black"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorBlack_Click">
                                                                            <Viewbox
                                                                                x:Name="ViewboxBtnColorBlackContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BorderPenColorWhite"
                                                                            Background="White"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorWhite_Click">
                                                                            <Viewbox
                                                                                x:Name="ViewboxBtnColorWhiteContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-black.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BorderPenColorRed"
                                                                            Background="#dc2626"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorRed_Click">
                                                                            <Viewbox x:Name="ViewboxBtnColorRedContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BorderPenColorPink"
                                                                            Background="#c72ec7"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorPink_Click">
                                                                            <Viewbox
                                                                                x:Name="ViewboxBtnColorPinkContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                    </Controls:UniformGrid>
                                                                </ikw:SimpleStackPanel>
                                                                <ikw:SimpleStackPanel Height="50"
                                                                    Orientation="Horizontal" Width="310">
                                                                    <Controls:UniformGrid Columns="5" Width="310">
                                                                        <Border x:Name="BorderPenColorOrange"
                                                                            Background="#ea580c"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorOrange_Click">
                                                                            <Viewbox
                                                                                x:Name="ViewboxBtnColorOrangeContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BorderPenColorYellow"
                                                                            Background="#eab308"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorYellow_Click">
                                                                            <Viewbox
                                                                                x:Name="ViewboxBtnColorYellowContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BorderPenColorGreen"
                                                                            Background="#16a34a"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorGreen_Click">
                                                                            <Viewbox
                                                                                x:Name="ViewboxBtnColorGreenContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BorderPenColorTeal"
                                                                            Background="#0d9488"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorTeal_Click">
                                                                            <Viewbox
                                                                                x:Name="ViewboxBtnColorTealContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                        <Border x:Name="BorderPenColorBlue"
                                                                            Background="#2563eb"
                                                                            BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                            BorderThickness="1.5" CornerRadius="100"
                                                                            Width="50" MouseUp="BtnColorBlue_Click">
                                                                            <Viewbox
                                                                                x:Name="ViewboxBtnColorBlueContent"
                                                                                Visibility="Collapsed" Margin="8">
                                                                                <Image
                                                                                    Source="/Resources/Icons-png/checked-white.png"
                                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                                    VerticalAlignment="Top" Width="24"
                                                                                    Height="24" />
                                                                            </Viewbox>
                                                                        </Border>
                                                                    </Controls:UniformGrid>
                                                                </ikw:SimpleStackPanel>
                                                            </Controls:UniformGrid>
                                                        </Border>
                                                    </ikw:SimpleStackPanel>
                                                </ikw:SimpleStackPanel>
                                            </Viewbox>
                                            <ikw:SimpleStackPanel Width="115">
                                                <TextBlock Margin="0,40,0,5" Text="荧光笔"
                                                           Foreground="{DynamicResource FloatBarForeground}"
                                                           FontWeight="Bold" TextAlignment="Center" />

                                                <ikw:SimpleStackPanel Orientation="Horizontal"
                                                                     VerticalAlignment="Center" Spacing="5">
                                                    <TextBlock Text="不透明度"
                                                               Foreground="{DynamicResource FloatBarForeground}"
                                                               FontSize="10" TextAlignment="Left" />
                                                    <Viewbox Height="16">
                                                        <Slider x:Name="InkAlphaSlider" Minimum="20" Maximum="240"
                                                                Value="120" Width="140" IsSnapToTickEnabled="True"
                                                                TickFrequency="20" TickPlacement="None"
                                                                ValueChanged="InkAlphaSlider_ValueChanged" />
                                                    </Viewbox>
                                                </ikw:SimpleStackPanel>

                                                <ikw:SimpleStackPanel>
                                                    <Controls:UniformGrid Rows="2" Height="65">
                                                        <ikw:SimpleStackPanel Height="25" Orientation="Horizontal"
                                                                             Width="115">
                                                            <Controls:UniformGrid Columns="3" Width="115">
                                                                <Border x:Name="BorderHighlighterColorRed"
                                                                        Background="#ff5e53"
                                                                        BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                        BorderThickness="1" CornerRadius="4" Width="30"
                                                                        MouseUp="BtnHighlighterColorRed_Click">
                                                                    <Viewbox
                                                                        x:Name="ViewboxBtnHighlighterColorRedContent"
                                                                        Visibility="Collapsed" Margin="2">
                                                                        <Image
                                                                            Source="/Resources/Icons-png/checked-white.png"
                                                                            RenderOptions.BitmapScalingMode="HighQuality"
                                                                            VerticalAlignment="Top" Width="28"
                                                                            Height="28" />
                                                                    </Viewbox>
                                                                </Border>
                                                                <Border x:Name="BorderHighlighterColorOrange"
                                                                        Background="#ff700d"
                                                                        BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                        BorderThickness="1" CornerRadius="4" Width="30"
                                                                        MouseUp="BtnHighlighterColorOrange_Click">
                                                                    <Viewbox
                                                                        x:Name="ViewboxBtnHighlighterColorOrangeContent"
                                                                        Visibility="Collapsed" Margin="2">
                                                                        <Image
                                                                            Source="/Resources/Icons-png/checked-white.png"
                                                                            RenderOptions.BitmapScalingMode="HighQuality"
                                                                            VerticalAlignment="Top" Width="28"
                                                                            Height="28" />
                                                                    </Viewbox>
                                                                </Border>
                                                                <Border x:Name="BorderHighlighterColorYellow"
                                                                        Background="#ffd308"
                                                                        BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                        BorderThickness="1" CornerRadius="4" Width="30"
                                                                        MouseUp="BtnHighlighterColorYellow_Click">
                                                                    <Viewbox
                                                                        x:Name="ViewboxBtnHighlighterColorYellowContent"
                                                                        Visibility="Collapsed" Margin="2">
                                                                        <Image
                                                                            Source="/Resources/Icons-png/checked-white.png"
                                                                            RenderOptions.BitmapScalingMode="HighQuality"
                                                                            VerticalAlignment="Top" Width="28"
                                                                            Height="28" />
                                                                    </Viewbox>
                                                                </Border>
                                                            </Controls:UniformGrid>
                                                        </ikw:SimpleStackPanel>
                                                        <ikw:SimpleStackPanel Height="25" Orientation="Horizontal"
                                                                             Width="115">
                                                            <Controls:UniformGrid Columns="3" Width="115">
                                                                <Border x:Name="BorderHighlighterColorTeal"
                                                                        Background="#10baab"
                                                                        BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                        BorderThickness="1" CornerRadius="4" Width="30"
                                                                        MouseUp="BtnHighlighterColorTeal_Click">
                                                                    <Viewbox
                                                                        x:Name="ViewboxBtnHighlighterColorTealContent"
                                                                        Visibility="Collapsed" Margin="2">
                                                                        <Image
                                                                            Source="/Resources/Icons-png/checked-white.png"
                                                                            RenderOptions.BitmapScalingMode="HighQuality"
                                                                            VerticalAlignment="Top" Width="28"
                                                                            Height="28" />
                                                                    </Viewbox>
                                                                </Border>
                                                                <Border x:Name="BorderHighlighterColorBlue"
                                                                        Background="#4a76ff"
                                                                        BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                        BorderThickness="1" CornerRadius="4" Width="30"
                                                                        MouseUp="BtnHighlighterColorBlue_Click">
                                                                    <Viewbox
                                                                        x:Name="ViewboxBtnHighlighterColorBlueContent"
                                                                        Visibility="Collapsed" Margin="2">
                                                                        <Image
                                                                            Source="/Resources/Icons-png/checked-white.png"
                                                                            RenderOptions.BitmapScalingMode="HighQuality"
                                                                            VerticalAlignment="Top" Width="28"
                                                                            Height="28" />
                                                                    </Viewbox>
                                                                </Border>
                                                                <Border x:Name="BorderHighlighterColorPurple"
                                                                        Background="#9333ea"
                                                                        BorderBrush="{DynamicResource FloatBarBorderBrush}"
                                                                        BorderThickness="1" CornerRadius="4" Width="30"
                                                                        MouseUp="BtnHighlighterColorPurple_Click">
                                                                    <Viewbox
                                                                        x:Name="ViewboxBtnHighlighterColorPurpleContent"
                                                                        Visibility="Collapsed" Margin="2">
                                                                        <Image
                                                                            Source="/Resources/Icons-png/checked-white.png"
                                                                            RenderOptions.BitmapScalingMode="HighQuality"
                                                                            VerticalAlignment="Top" Width="28"
                                                                            Height="28" />
                                                                    </Viewbox>
                                                                </Border>
                                                            </Controls:UniformGrid>
                                                        </ikw:SimpleStackPanel>
                                                    </Controls:UniformGrid>
                                                </ikw:SimpleStackPanel>


                                            </ikw:SimpleStackPanel>
                                        </ikw:SimpleStackPanel>
                                    </ikw:SimpleStackPanel>
                                </Border>
                            </Grid>
                            <ikw:SimpleStackPanel Name="Eraser_Icon" MouseUp="EraserIcon_Click"
                                                 MouseDown="Border_MouseDown" Background="Transparent"
                                                 Orientation="Vertical" HorizontalAlignment="Center">
                                <ui:FontIcon Height="22" Width="30" FontSize="16"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe75c;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <ui:FontIcon Margin="5,-22,0,-8" Height="22" Width="20" FontSize="12"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf0b6;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="圆形擦" Margin="1,-1,0,0"
                                           Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                           Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                           TextAlignment="Center" />
                            </ikw:SimpleStackPanel>
                            <ikw:SimpleStackPanel Name="EraserByStrokes_Icon" MouseUp="EraserIconByStrokes_Click"
                                                 MouseDown="Border_MouseDown" Background="Transparent"
                                                 Orientation="Vertical" HorizontalAlignment="Center">
                                <ui:FontIcon Height="22" Width="30" FontSize="16"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe75c;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <ui:FontIcon Margin="12,-22,0,-8" Height="22" Width="10" FontSize="8"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf128;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="墨迹擦" Margin="1,-1,0,0"
                                           Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                           Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                           TextAlignment="Center" />
                            </ikw:SimpleStackPanel>
                            <ikw:SimpleStackPanel Name="SymbolIconSelect" MouseDown="Border_MouseDown"
                                                 MouseUp="SymbolIconSelect_MouseUp" Background="Transparent"
                                                 Orientation="Vertical" HorizontalAlignment="Center">
                                <ui:FontIcon Height="22" Width="30" FontSize="16"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe958;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <ui:FontIcon Margin="6,-18,0,-8" Height="22" Width="10" FontSize="10"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf8af;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="选择" Margin="1,-1,0,0"
                                           Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                           Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                           TextAlignment="Center" />
                            </ikw:SimpleStackPanel>
                            <ikw:SimpleStackPanel MouseDown="Border_MouseDown" MouseUp="ImageDrawShape_MouseUp"
                                                 Background="Transparent" Orientation="Vertical"
                                                 HorizontalAlignment="Center">
                                <ui:FontIcon Height="22" Width="30" FontSize="16"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xf158;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="图形" Margin="1,-1,0,0"
                                           Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                           Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                           TextAlignment="Center" />
                            </ikw:SimpleStackPanel>
                            <Grid Width="0">
                                <Border x:Name="BorderDrawShape" Visibility="Visible"
                                        Background="{DynamicResource FloatBarBackground}"
                                        BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                        CornerRadius="5" Margin="-112,-240,-88,28" Height="230">
                                    <ikw:SimpleStackPanel Orientation="Vertical">
                                        <Border Background="{DynamicResource FloatBarTitleBackground}"
                                                BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                                CornerRadius="5,5,0,0" Margin="-1 -1 -1 0" Padding="15,5,0,5">
                                            <ikw:SimpleStackPanel Orientation="Horizontal">
                                                <TextBlock Text="图形(第一行支持长按保持选中)" FontSize="10"
                                                           Foreground="{DynamicResource FloatBarForeground}"
                                                           FontWeight="Bold" />
                                                <ui:SymbolIcon Margin="25 0 0 0" FontSize="12" Symbol="Pin"
                                                               MouseDown="Border_MouseDown"
                                                               MouseUp="SymbolIconPinBorderDrawShape_MouseUp"
                                                               Foreground="{DynamicResource FloatBarForeground}"
                                                               HorizontalAlignment="Right" />
                                            </ikw:SimpleStackPanel>
                                        </Border>
                                        <ikw:SimpleStackPanel Visibility="Collapsed" Margin="20,5,0,0"
                                                             Orientation="Horizontal">
                                            <ikw:SimpleStackPanel>
                                                <Label Margin="0,0,0,-2" Content="自动隐藏"
                                                       Foreground="{DynamicResource FloatBarForeground}" FontSize="13"
                                                       VerticalAlignment="Center" />
                                                <Viewbox Height="25">
                                                    <ui:ToggleSwitch Name="ToggleSwitchDrawShapeBorderAutoHide"
                                                                     Foreground="{DynamicResource FloatBarForeground}"
                                                                     Width="70" OnContent="开" OffContent="关"
                                                                     IsOn="True" />
                                                </Viewbox>
                                            </ikw:SimpleStackPanel>
                                        </ikw:SimpleStackPanel>
                                        <Viewbox Width="200">
                                            <ikw:SimpleStackPanel Spacing="-8">
                                                <ikw:SimpleStackPanel Height="50" Spacing="14" Orientation="Horizontal">
                                                    <Image x:Name="ImageDrawLine" Margin="16,12,0,12"
                                                           MouseDown="Image_MouseDown" MouseUp="BtnDrawLine_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Line}" />
                                                    <Image x:Name="ImageDrawDashedLine" Margin="0,12,0,12"
                                                           MouseDown="Image_MouseDown"
                                                           MouseUp="BtnDrawDashedLine_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.DashedLine}" />
                                                    <Image x:Name="ImageDrawDotLine" Margin="0,12,0,12"
                                                           MouseDown="Image_MouseDown" MouseUp="BtnDrawDotLine_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.DotLine}" />
                                                    <Image x:Name="ImageDrawArrow" Margin="0,12,0,12"
                                                           MouseDown="Image_MouseDown" MouseUp="BtnDrawArrow_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.ArrowLine}" />
                                                    <Image x:Name="ImageDrawParallelLine" Margin="0,11.5,16,11.5"
                                                           MouseDown="Image_MouseDown"
                                                           MouseUp="BtnDrawParallelLine_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.ParallelLine}" />
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel Height="50" Spacing="15" Orientation="Horizontal">
                                                    <Image Margin="16,12,0,12" MouseUp="BtnDrawCoordinate1_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Coordinate1}" />
                                                    <Image Margin="0,12" MouseUp="BtnDrawCoordinate2_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Coordinate2}" />
                                                    <Image Margin="0,12" MouseUp="BtnDrawCoordinate3_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Coordinate3}" />
                                                    <Image Margin="0,12" MouseUp="BtnDrawCoordinate4_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Coordinate4}" />
                                                    <Image Margin="-1,11.5" MouseUp="BtnDrawCoordinate5_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Coordinate5}" />
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                    <Image Margin="16,11,2,11" MouseUp="BtnDrawRectangleCenter_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.RectangleCenter}" />
                                                    <Image Visibility="Collapsed" Margin="0,10"
                                                           MouseUp="BtnDrawEllipse_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Ellipse}" />
                                                    <Image Margin="0,10" MouseUp="BtnDrawCircle_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Circle}" />
                                                    <Image Margin="0,10" MouseUp="BtnDrawDashedCircle_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.DashedCircle}" />
                                                    <Image Margin="0,10" MouseUp="BtnDrawCenterEllipse_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.EllipseCenter}"
                                                           Width="30" />
                                                    <Image Margin="0,10"
                                                           MouseUp="BtnDrawCenterEllipseWithFocalPoint_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.EllipseCenterWithFocalPoint}"
                                                           Width="30" />
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                    <Image Margin="16,10,2,10" MouseUp="BtnDrawHyperbola_Click"
                                                           Width="26"
                                                           Source="{DynamicResource DrawShapeImageSource.Hyperbola}" />
                                                    <Image Margin="4,10,2,10"
                                                           MouseUp="BtnDrawHyperbolaWithFocalPoint_Click" Width="26"
                                                           Source="{DynamicResource DrawShapeImageSource.HyperbolaWithFocalPoint}" />
                                                    <Image Margin="2.5,10,2,10" MouseUp="BtnDrawParabola1_Click"
                                                           Width="26"
                                                           Source="{DynamicResource DrawShapeImageSource.Parabola}" />
                                                    <Image Margin="1,10,2,10"
                                                           MouseUp="BtnDrawParabolaWithFocalPoint_Click" Width="26"
                                                           Source="{DynamicResource DrawShapeImageSource.ParabolaWithFocalPoint}"
                                                           RenderTransformOrigin="0.5,0.5">
                                                        <Image.RenderTransform>
                                                            <TransformGroup>
                                                                <ScaleTransform />
                                                                <SkewTransform />
                                                                <RotateTransform Angle="90" />
                                                                <TranslateTransform />
                                                            </TransformGroup>
                                                        </Image.RenderTransform>
                                                    </Image>
                                                    <Image Margin="2,10,2,10" MouseUp="BtnDrawParabola2_Click"
                                                           Width="26"
                                                           Source="{DynamicResource DrawShapeImageSource.Parabola}"
                                                           RenderTransformOrigin="0.5,0.5">
                                                        <Image.RenderTransform>
                                                            <TransformGroup>
                                                                <ScaleTransform />
                                                                <SkewTransform />
                                                                <RotateTransform Angle="90" />
                                                                <TranslateTransform />
                                                            </TransformGroup>
                                                        </Image.RenderTransform>
                                                    </Image>
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                    <Image Margin="15,11,2,11" MouseUp="BtnDrawRectangle_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Rectangle}" />
                                                    <Image Margin="6,10,2,10" MouseUp="BtnDrawCylinder_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Cylinder}" />
                                                    <Image Margin="8,12.5,0,10" MouseUp="BtnDrawCone_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Cone}" />
                                                    <Image Margin="5.5,12.5,2.5,10" MouseUp="BtnDrawCuboid_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Cuboid}" />
                                                    <Image Visibility="Collapsed" Margin="0,11.5,2.5,9.5"
                                                           MouseUp="BtnDrawCuboid_Click"
                                                           Source="{DynamicResource DrawShapeImageSource.Tetrahedron}" />
                                                </ikw:SimpleStackPanel>
                                            </ikw:SimpleStackPanel>
                                        </Viewbox>
                                    </ikw:SimpleStackPanel>
                                </Border>
                            </Grid>
                            <ikw:SimpleStackPanel MouseDown="Border_MouseDown" MouseUp="SymbolIconUndo_MouseUp"
                                                 Background="Transparent" Orientation="Vertical"
                                                 HorizontalAlignment="Center"
                                                 IsEnabled="{Binding ElementName=BtnUndo, Path=IsEnabled}">
                                <ui:FontIcon Margin="0,2,0,-2" Height="22" Width="30" FontSize="16"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe7a7;"
                                             Foreground="{DynamicResource FloatBarForeground}"
                                             Opacity="{Binding ElementName=BtnUndo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}" />
                                <TextBlock Text="撤销" Margin="1,-1,0,0"
                                           Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                           Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                           TextAlignment="Center" />
                            </ikw:SimpleStackPanel>
                            <ikw:SimpleStackPanel MouseDown="Border_MouseDown" MouseUp="SymbolIconRedo_MouseUp"
                                                 Background="Transparent" Orientation="Vertical"
                                                 HorizontalAlignment="Center"
                                                 IsEnabled="{Binding ElementName=BtnRedo, Path=IsEnabled}">
                                <ui:FontIcon Margin="0,2,0,-2" Height="22" Width="30" FontSize="16"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe7a6;"
                                             Foreground="{DynamicResource FloatBarForeground}"
                                             Opacity="{Binding ElementName=BtnRedo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}" />
                                <TextBlock Text="重做" Margin="1,-1,0,0"
                                           Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                           Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                           TextAlignment="Center" />
                            </ikw:SimpleStackPanel>
                            <ikw:SimpleStackPanel Margin="1.5,0,2.5,0" MouseDown="Border_MouseDown"
                                                 MouseUp="CursorWithDelIcon_Click" Background="Transparent"
                                                 Orientation="Vertical" HorizontalAlignment="Center">
                                <ui:FontIcon Margin="-5,0,0,0" Height="22" Width="30" FontSize="14"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe8b0;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <ui:FontIcon Margin="12,-22,0,-8" Height="22" Width="15" FontSize="10"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe74d;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="清并鼠" Margin="1,-1,0,0"
                                           Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                           Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                           TextAlignment="Center" />
                            </ikw:SimpleStackPanel>
                        </ikw:SimpleStackPanel>
                        <ikw:SimpleStackPanel
                            Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <Border Margin="0,2" BorderBrush="{DynamicResource FloatBarForeground}"
                                    BorderThickness="1,0,0,0" MouseDown="Border_MouseDown"
                                    MouseUp="ImageBlackboard_MouseUp">
                                <ikw:SimpleStackPanel Margin="2,-2,0,-2" Orientation="Vertical"
                                                     HorizontalAlignment="Center" Background="Transparent">
                                    <ui:FontIcon Margin="0,2,0,-2" Height="22" Width="30" FontSize="16"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe929;"
                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                    <TextBlock Margin="0,-1,0,0" Text="画板"
                                               Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                               Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                               TextAlignment="Center" />
                                </ikw:SimpleStackPanel>
                            </Border>
                            <ikw:SimpleStackPanel MouseDown="Border_MouseDown" MouseUp="SymbolIconTools_MouseUp"
                                                 Background="Transparent" Orientation="Vertical"
                                                 HorizontalAlignment="Center">
                                <ui:FontIcon Height="22" Width="30" FontSize="16"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe8a9;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Margin="0,-1,0,0" Text="工具"
                                           Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                           Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                           TextAlignment="Center" />
                            </ikw:SimpleStackPanel>
                            <ikw:SimpleStackPanel x:Name="Fold_Icon" MouseDown="Border_MouseDown"
                                                 MouseUp="FoldFloatingBar_MouseUp" Background="Transparent"
                                                 Orientation="Vertical" HorizontalAlignment="Center">
                                <ui:FontIcon Height="22" Width="30" FontSize="16"
                                             FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xed1a;"
                                             Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Margin="0,-1,0,0" Text="隐藏"
                                           Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                           Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                           TextAlignment="Center" />
                            </ikw:SimpleStackPanel>
                            <Grid Width="0">
                                <Border Name="BorderTools" Margin="-125,-180,-45,40" CornerRadius="5"
                                        Background="{DynamicResource FloatBarBackground}" BorderThickness="1"
                                        BorderBrush="{DynamicResource FloatBarBorderBrush}">
                                    <ikw:SimpleStackPanel>
                                        <Border Background="{DynamicResource FloatBarTitleBackground}"
                                                BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                                CornerRadius="5,5,0,0" Margin="-1 -1 -1 0" Padding="15,5">
                                            <TextBlock Text="更多设置" Foreground="{DynamicResource FloatBarForeground}"
                                                       FontWeight="Bold" />
                                        </Border>
                                        <ikw:SimpleStackPanel HorizontalAlignment="Center" Spacing="4">
                                            <ikw:SimpleStackPanel Margin="0,5,0,0" Height="40" Spacing="8"
                                                                 Orientation="Horizontal">
                                                <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                     MouseUp="ImageCountdownTimer_MouseUp" Height="40"
                                                                     Width="40" Orientation="Vertical">
                                                    <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                 FontFamily="{StaticResource FluentIconFontFamily}"
                                                                 Glyph="&#xea8f;"
                                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Label Content="倒计时" FontSize="10" HorizontalAlignment="Center"
                                                           Foreground="{DynamicResource FloatBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                     MouseUp="SymbolIconRand_MouseUp" Height="40"
                                                                     Width="40" Orientation="Vertical">
                                                    <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                 FontFamily="{StaticResource FluentIconFontFamily}"
                                                                 Glyph="&#xe8b1;"
                                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Label Content="随机抽选" FontSize="10" HorizontalAlignment="Center"
                                                           Foreground="{DynamicResource FloatBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                     MouseUp="SymbolIconRandOne_MouseUp" Height="40"
                                                                     Width="40" Orientation="Vertical">
                                                    <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                 FontFamily="{StaticResource FluentIconFontFamily}"
                                                                 Glyph="&#xe8b1;"
                                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Border CornerRadius="50"
                                                            BorderBrush="{DynamicResource FloatBarForeground}"
                                                            BorderThickness="1" HorizontalAlignment="Center"
                                                            Margin="-2,-10,0,-2" VerticalAlignment="Bottom" Height="9"
                                                            Width="9">
                                                        <TextBlock Text="1" FontSize="7" HorizontalAlignment="Center"
                                                                   VerticalAlignment="Top" Margin="0,-0.8,0,0"
                                                                   Foreground="{DynamicResource FloatBarForeground}" />
                                                    </Border>
                                                    <Label Content="单次抽选" FontSize="10" HorizontalAlignment="Center"
                                                           Foreground="{DynamicResource FloatBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                            </ikw:SimpleStackPanel>
                                            <ikw:SimpleStackPanel Height="40" Spacing="8" Orientation="Horizontal">
                                                <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                     MouseUp="SymbolIconSaveStrokes_MouseUp"
                                                                     Height="40" Width="40" Orientation="Vertical">
                                                    <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                 FontFamily="{StaticResource FluentIconFontFamily}"
                                                                 Glyph="&#xe74e;"
                                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Label Content="保存墨迹" FontSize="10" HorizontalAlignment="Center"
                                                           Foreground="{DynamicResource FloatBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                     MouseUp="SymbolIconOpenStrokes_MouseUp"
                                                                     Height="40" Width="40" Orientation="Vertical">
                                                    <ui:FontIcon Margin="0,4,-2,2" Height="22" Width="22"
                                                                 FontFamily="{StaticResource FluentIconFontFamily}"
                                                                 Glyph="&#xed25;"
                                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Label Content="打开墨迹" FontSize="10" HorizontalAlignment="Center"
                                                           Foreground="{DynamicResource FloatBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                     MouseUp="GridInkReplayButton_MouseUp" Height="40"
                                                                     Width="40" Orientation="Vertical">
                                                    <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                 FontFamily="{StaticResource FluentIconFontFamily}"
                                                                 Glyph="&#xec57;"
                                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Label Content="播放墨迹" FontSize="10" HorizontalAlignment="Center"
                                                           Foreground="{DynamicResource FloatBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                            </ikw:SimpleStackPanel>
                                            <ikw:SimpleStackPanel Height="40" Spacing="8" Orientation="Horizontal">
                                                <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                     MouseUp="SymbolIconScreenshot_MouseUp" Height="40"
                                                                     Width="40" Orientation="Vertical">
                                                    <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                 FontFamily="{StaticResource FluentIconFontFamily}"
                                                                 Glyph="&#xe722;"
                                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Label Content="截屏" FontSize="10" HorizontalAlignment="Center"
                                                           Foreground="{DynamicResource FloatBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                     MouseUp="OperatingGuideWindowIcon_MouseUp"
                                                                     Height="40" Width="40" Orientation="Vertical">
                                                    <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                 FontFamily="{StaticResource FluentIconFontFamily}"
                                                                 Glyph="&#xe82d;"
                                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Label Content="指南" FontSize="10" HorizontalAlignment="Center"
                                                           Foreground="{DynamicResource FloatBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                                <ikw:SimpleStackPanel MouseDown="Border_MouseDown"
                                                                     MouseUp="SymbolIconSettings_Click" Height="40"
                                                                     Width="40" Orientation="Vertical">
                                                    <ui:FontIcon Margin="0,4,0,2" Height="22" Width="22"
                                                                 FontFamily="{StaticResource FluentIconFontFamily}"
                                                                 Glyph="&#xe713;"
                                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Label Content="设置" FontSize="10" HorizontalAlignment="Center"
                                                           Foreground="{DynamicResource FloatBarForeground}" />
                                                </ikw:SimpleStackPanel>
                                            </ikw:SimpleStackPanel>
                                        </ikw:SimpleStackPanel>
                                    </ikw:SimpleStackPanel>
                                </Border>
                            </Grid>
                        </ikw:SimpleStackPanel>
                    </ikw:SimpleStackPanel>
                </Border>

                <Border Margin="2,0,0,0" x:Name="EnableTwoFingerGestureBorder" Visibility="Visible" Width="36"
                        Height="36" MouseUp="TwoFingerGestureBorder_MouseUp" CornerRadius="5"
                        Background="{DynamicResource FloatBarBackground}"
                        BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1">
                    <ikw:SimpleStackPanel>
                        <ui:FontIcon Margin="0,1.5,0,-1.5" x:Name="EnableTwoFingerGestureBtn" Opacity="0.5" Height="22"
                                     Width="28" FontSize="20" FontFamily="{StaticResource FluentIconFontFamily}"
                                     Glyph="&#xf271;" Foreground="{DynamicResource FloatBarForeground}" />
                        <TextBlock Text="手势"
                                   Visibility="{Binding ElementName=FloatBarSelectIconTextBlock, Path=Visibility}"
                                   Foreground="{DynamicResource FloatBarForeground}" FontSize="8"
                                   TextAlignment="Center" />
                    </ikw:SimpleStackPanel>
                </Border>
                <Grid Width="0">
                    <Border Name="TwoFingerGestureBorder" VerticalAlignment="Top" Visibility="Visible"
                            Margin="-89,-134,-54,0" CornerRadius="5" Background="{DynamicResource FloatBarBackground}"
                            BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1">
                        <ikw:SimpleStackPanel>
                            <Border Background="{DynamicResource FloatBarTitleBackground}"
                                    BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                    CornerRadius="5,5,0,0" Margin="-1 -1 -1 0" Padding="15,5">
                                <TextBlock Text="手势选项" FontSize="10" Foreground="{DynamicResource FloatBarForeground}"
                                           FontWeight="Bold" />
                            </Border>
                            <ikw:SimpleStackPanel Margin="5,2,5,3" Spacing="-2.5">
                                <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center"
                                                     HorizontalAlignment="Center">
                                    <ui:FontIcon Margin="0,4,0,2" Height="20" Width="20" FontSize="16"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe716;"
                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                    <Label Content="多指书写" FontSize="12" VerticalAlignment="Center"
                                           Foreground="{DynamicResource FloatBarForeground}" />
                                    <Viewbox Width="36" Height="25">
                                        <ui:ToggleSwitch MinWidth="0" Width="42"
                                                         Name="ToggleSwitchEnableMultiTouchMode" IsOn="False"
                                                         OnContent="" OffContent=""
                                                         Toggled="ToggleSwitchEnableMultiTouchMode_Toggled" />
                                    </Viewbox>
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel
                                    Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}"
                                    x:Name="TwoFingerGestureSimpleStackPanel" Orientation="Horizontal" Spacing="8"
                                    VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <ui:FontIcon Margin="0,4,0,2" Height="20" Width="20" FontSize="16"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe7c2;"
                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                    <Label Content="双指移动" FontSize="12" VerticalAlignment="Center"
                                           Foreground="{DynamicResource FloatBarForeground}" />
                                    <Viewbox Width="36" Height="25">
                                        <ui:ToggleSwitch MinWidth="0" Width="42" OnContent="" OffContent=""
                                                         Name="ToggleSwitchEnableTwoFingerTranslate" IsOn="False"
                                                         Toggled="ToggleSwitchEnableTwoFingerTranslate_Toggled" />
                                    </Viewbox>
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel
                                    Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}"
                                    Orientation="Horizontal" Spacing="8" VerticalAlignment="Center"
                                    HorizontalAlignment="Center">
                                    <ui:FontIcon Margin="0,4,0,2" Height="20" Width="20" FontSize="16"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe740;"
                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                    <Label Content="双指缩放" FontSize="12" VerticalAlignment="Center"
                                           Foreground="{DynamicResource FloatBarForeground}" />
                                    <Viewbox Width="36" Height="25">
                                        <ui:ToggleSwitch MinWidth="0" Width="42" OnContent="" OffContent=""
                                                         Name="ToggleSwitchEnableTwoFingerZoom" IsOn="False"
                                                         Toggled="ToggleSwitchEnableTwoFingerZoom_Toggled" />
                                    </Viewbox>
                                </ikw:SimpleStackPanel>
                                <ikw:SimpleStackPanel
                                    Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}"
                                    Orientation="Horizontal" Spacing="8" VerticalAlignment="Center"
                                    HorizontalAlignment="Center">
                                    <ui:FontIcon Margin="0,4,0,2" Height="20" Width="20" FontSize="16"
                                                 FontFamily="{StaticResource FluentIconFontFamily}" Glyph="&#xe7ad;"
                                                 Foreground="{DynamicResource FloatBarForeground}" />
                                    <Label Content="双指旋转" FontSize="12" VerticalAlignment="Center"
                                           Foreground="{DynamicResource FloatBarForeground}" />
                                    <Viewbox Width="36" Height="25">
                                        <ui:ToggleSwitch MinWidth="0" Width="42" OnContent="" OffContent=""
                                                         Name="ToggleSwitchEnableTwoFingerRotation"
                                                         Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled" />
                                    </Viewbox>
                                </ikw:SimpleStackPanel>
                            </ikw:SimpleStackPanel>
                        </ikw:SimpleStackPanel>
                    </Border>
                </Grid>

                <Border x:Name="BorderFloatingBarExitPPTBtn" Margin="2,0,0,0" Width="34" Height="36"
                        MouseDown="Border_MouseDown" MouseUp="ImagePPTControlEnd_MouseUp"
                        Background="{DynamicResource FloatBarBackground}" CornerRadius="4" BorderThickness="1"
                        BorderBrush="{DynamicResource FloatBarBorderBrush}"
                        Visibility="{Binding ElementName=BtnPPTSlideShowEnd, Path=Visibility}">
                    <Grid>
                        <Image Source="{DynamicResource ResourceKey=SeewoImageSource.PPTExitNormal}"
                               Visibility="{Binding ElementName=BtnPPTSlideShowEnd, Path=Visibility}" Height="20"
                               Width="30" />
                    </Grid>
                </Border>
            </ikw:SimpleStackPanel>
        </Viewbox>

        <!--// 笑脸拖动 //-->
        <Grid Name="GridForFloatingBarDraging" Background="#01000000" Visibility="Collapsed"
              MouseMove="SymbolIconEmoji_MouseMove" MouseUp="SymbolIconEmoji_MouseUp" />

        <!--// 墨迹播放 //-->
        <InkCanvas Name="InkCanvasForInkReplay" MouseDown="InkCanvasForInkReplay_MouseDown" Visibility="Collapsed"
                   EditingMode="None" Background="Transparent" />

        <!--// 侧边栏 //-->
        <Viewbox x:Name="LeftSidePanel" MouseUp="UnFoldFloatingBar_MouseUp" Visibility="Visible" Height="50" Width="30"
                 Margin="-40,0,0,-150" HorizontalAlignment="Left" VerticalAlignment="Center">
            <ikw:SimpleStackPanel>
                <Border Background="LightGray" Opacity="0.4" CornerRadius="5" Height="50" Width="30">
                    <Image Margin="0,0,-15,0" Source="/Resources/Icons-png/penUpright.png"
                           RenderOptions.BitmapScalingMode="HighQuality" Height="50" Width="30" />
                </Border>
            </ikw:SimpleStackPanel>
        </Viewbox>
        <Viewbox x:Name="RightSidePanel" MouseUp="UnFoldFloatingBar_MouseUp"
                 Visibility="{Binding ElementName=LeftSidePanel, Path=Visibility}" Height="50" Width="30"
                 Margin="0,0,-40,-150" HorizontalAlignment="Right" VerticalAlignment="Center">
            <ikw:SimpleStackPanel>
                <Border Background="LightGray" Opacity="0.4" CornerRadius="5" Height="50" Width="30">
                    <Image Margin="-15,0,0,0" Source="/Resources/Icons-png/penUpright.png"
                           RenderOptions.BitmapScalingMode="HighQuality" Height="50" Width="30" />
                </Border>
            </ikw:SimpleStackPanel>
        </Viewbox>
    </Grid>
</Window>